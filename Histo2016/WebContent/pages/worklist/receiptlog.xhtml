<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://java.sun.com/jsp/jstl/core">

	<script type="text/javascript">
		// disables the autofocus for the caseHistoryOverlayplpanel 
		(function() {
			var proxied = PrimeFaces.widget.OverlayPanel.prototype.applyFocus;

			PrimeFaces.widget.OverlayPanel.prototype.applyFocus = function() {
				if (this.id == "contentForm:caseHistoryOverlayPanel")
					return;

				return proxied.apply(this, arguments);
			};
		})();
	</script>

	<ui:include src="common/navigationBar.xhtml"></ui:include>

	<c:set var="taskEditable" scope="session"
		value="#{taskStatusHandler.isTaskEditable(commonDataHandlerAction.selectedTask)}" />

	<p:panel style="width: 70%"
		styleClass="collapsedBorders noPadding noBorders">

		<h:outputLabel
			value="#{msg['body.receiptlog.taskId']} #{commonDataHandlerAction.selectedTask.taskID}"
			style="font-size:1.5em;"></h:outputLabel>

		<h:panelGrid columns="5" style="margin-top:10px;"
			styleClass="defaultListingTableThreeLineContainer">

			<!-- left column -->
			<h:panelGrid columns="2" styleClass="defaultListingTableFirstColumEnummeration">
				<!-- Receipt Date -->
				<h:outputLabel value="#{msg['body.receiptlog.taskEDate']}" />
				<p:calendar pattern="dd.MM.yyyy" mask="true" id="receiptDate"
					style="width: 80%;background:##{userHandlerAction.currentUser.inputFieldColor};color:##{userHandlerAction.currentUser.inputFieldFontColor}"
					styleClass="smallInput customBackground"
					disabled="#{!taskEditable}"
					value="#{commonDataHandlerAction.selectedTask.dateOfReceiptAsDate}">
					<p:ajax event="dateSelect"
						listener="#{diagnosisViewHandlerAction.onDataChange(commonDataHandlerAction.selectedTask,'log.patient.task.change.receiptDate',mainHandlerAction.date(commonDataHandlerAction.selectedTask.dateOfReceiptAsDate))}"
						update="receiptDate" />
					<f:ajax event="change" execute="@this" render="receiptDate"
						listener="#{diagnosisViewHandlerAction.onDataChange(commonDataHandlerAction.selectedTask,'log.patient.task.change.receiptDate',mainHandlerAction.date(commonDataHandlerAction.selectedTask.dateOfReceiptAsDate))}" />
				</p:calendar>

				<!-- Termin Date -->
				<h:outputLabel value="#{msg['body.receiptlog.taskDueDate']}" />
				<h:panelGrid columns="2" styleClass="defaultListingTableContainer">
					<p:selectBooleanCheckbox style="padding-right:5px;"
						disabled="#{!taskEditable}" styleClass="smallCheckbox"
						title="#{msg['body.receiptlog.taskDueDate.hint']}"
						value="#{commonDataHandlerAction.selectedTask.dueDateSelected}">
						<p:ajax event="change" execute="@this"
							update="navigationForm contentForm"
							listener="#{diagnosisViewHandlerAction.onDataChange(commonDataHandlerAction.selectedTask,'log.patient.task.change.dueDate',commonDataHandlerAction.selectedTask.dueDateSelected)}">
						</p:ajax>
					</p:selectBooleanCheckbox>
					<p:calendar pattern="dd.MM.yyyy" mask="true" id="dueDate"
						style="width: 80%;background:##{userHandlerAction.currentUser.inputFieldColor};color:##{userHandlerAction.currentUser.inputFieldFontColor};"
						styleClass="smallInput customBackground"
						value="#{commonDataHandlerAction.selectedTask.dueDateAsDate}"
						disabled="#{!commonDataHandlerAction.selectedTask.dueDateSelected or !taskEditable}">
						<p:ajax event="dateSelect"
							listener="#{diagnosisViewHandlerAction.onDataChange(commonDataHandlerAction.selectedTask,'log.patient.task.change.dueDate.date', mainHandlerAction.date(commonDataHandlerAction.selectedTask.dueDateAsDate))}"
							update="dueDate" />
						<f:ajax event="change" execute="@this" render="dueDate"
							listener="#{diagnosisViewHandlerAction.onDataChange(commonDataHandlerAction.selectedTask,'log.patient.task.change.dueDate.date', mainHandlerAction.date(commonDataHandlerAction.selectedTask.dueDateAsDate))}" />
					</p:calendar>
				</h:panelGrid>

				<!-- ward -->
				<h:outputLabel value="#{msg['body.diagnosis.ward']}" />
				<p:selectOneMenu id="wards"
					value="#{commonDataHandlerAction.selectedTask.ward}"
					style="width: 80%;background:##{userHandlerAction.currentUser.inputFieldColor};color:##{userHandlerAction.currentUser.inputFieldFontColor};"
					styleClass="smallInput customBackground" editable="true"
					disabled="#{!taskEditable}">
					<f:selectItems value="#{diagnosisViewHandlerAction.wardList}"
						itemValue="#{ward.value}" itemLabel="#{ward.value}" var="ward" />
					<p:ajax event="change" execute="@this"
						listener="#{diagnosisViewHandlerAction.onDataChange(commonDataHandlerAction.selectedTask,'log.patient.task.change.ward', commonDataHandlerAction.selectedTask.ward)}" />
				</p:selectOneMenu>

				<!-- History -->
				<h:outputLabel value="#{msg['body.receiptlog.story']}" />
				<h:panelGroup>
					<p:inputTextarea disabled="#{!taskEditable}"
						value="#{commonDataHandlerAction.selectedTask.caseHistory}"
						title="#{msg['body.diagnosis.story.watermark']}"
						id="caseHistoryInput" style="width:90%"
						onfocus="PF('caseHistoryOverlayPanel').show();">
						<p:ajax event="change"
							listener="#{diagnosisViewHandlerAction.onDataChange(commonDataHandlerAction.selectedTask,'log.patient.task.change.caseHistory',commonDataHandlerAction.selectedTask.caseHistory)}"></p:ajax>
					</p:inputTextarea>

					<p:overlayPanel id="caseHistoryOverlayPanel"
						styleClass="defaultOverlayPanel" for="caseHistoryInput"
						widgetVar="caseHistoryOverlayPanel" hideEffect="fade"
						style="width:500px" hideEvent="none" showEvent="none">
						<p:dataTable value="#{diagnosisViewHandlerAction.caseHistoryList}"
							var="item"
							styleClass="smallDatatable highlightedDataTable noBordersAll"
							scrollable="true" scrollHeight="200" rowKey="#{item.id}"
							selection="#{diagnosisViewHandlerAction.selectedCaseHistoryItem}"
							selectionMode="single">
							<p:column filterBy="#{item.value}" filterMatchMode="contains">
								<h:outputText value="#{item.value}" />
							</p:column>

							<p:ajax event="rowSelect" update="contentForm:caseHistoryInput"
								listener="#{diagnosisViewHandlerAction.copyCaseHistory(commonDataHandlerAction.selectedTask, diagnosisViewHandlerAction.selectedCaseHistoryItem)}"
								oncomplete="PF('caseHistoryOverlayPanel').hide();" />
						</p:dataTable>

					</p:overlayPanel>
				</h:panelGroup>

				<!-- EYE -->
				<h:outputLabel value="#{msg['body.receiptlog.eye']}" />
				<p:selectOneMenu
					style="width: 80%;background:##{userHandlerAction.currentUser.inputFieldColor};color:##{userHandlerAction.currentUser.inputFieldFontColor};"
					styleClass="smallInput customBackground"
					value="#{commonDataHandlerAction.selectedTask.eye}"
					disabled="#{!taskEditable}">

					<f:selectItems value="#{enumProvider.eyes}" var="eye"
						itemLabel="#{msg['enum.eye.'.concat(eye)]}" itemValue="#{eye}" />

					<p:ajax event="change" execute="@this"
						listener="#{diagnosisViewHandlerAction.onDataChange(commonDataHandlerAction.selectedTask,'log.patient.task.change.eye',commonDataHandlerAction.selectedTask.eye)}" />
				</p:selectOneMenu>

				<!-- other -->
				<h:outputLabel value="#{msg['body.receiptlog.miscellaneous']}" />
				<h:panelGroup>
					<p:commandButton icon="fa fa-fw fa-taxi" disabled="true"
						title="#{msg['body.receiptlog.miscellaneous.borrow']}" />
					<p:commandButton icon="fa fa-fw fa-dollar" disabled="true"
						actionListener="#{mainHandlerAction.showDialog('WORKLIST_ACCOUNTING')}"
						title="#{msg['body.receiptlog.miscellaneous.accounting']}" />
				</h:panelGroup>
			</h:panelGrid>
			<!-- left column -->

			<h:panelGroup />

			<!-- middle column -->
			<h:panelGrid columns="1" styleClass="defaultListingTable">
				<!-- material -->
				<p:outputLabel value="#{msg['body.receiptlog.material']}"
					styleClass="big-text" />
				<h:panelGrid columns="1" styleClass="defaultListingTableContainer">
					<c:forEach items="#{commonDataHandlerAction.selectedTask.samples}"
						var="sample" varStatus="loopCount">

						<h:panelGrid columns="3" styleClass="defaultListingTableContainer">
							<h:outputLabel
								value="#{msg['body.diagnosis.diagnosis.sample']} #{sample.sampleID}" />

							<p:inputText value="#{sample.material}"
								disabled="#{!taskEditable}"
								style="margin-left:10px;background:##{userHandlerAction.currentUser.inputFieldColor};color:##{userHandlerAction.currentUser.inputFieldFontColor};"
								styleClass="smallInput customBackground" />

							<p:commandLink
								title="#{msg['body.receiptlog.notification.hint']}"
								disabled="#{!taskEditable}"
								actionListener="#{dialogHandlerAction.changeMaterialDialog.initAndPrepareBean(sample)}">
								<i class="fa fa-fw fa-cog" />
								<p:ajax event="dialogReturn" update="navigationForm contentForm" />
							</p:commandLink>
						</h:panelGrid>
					</c:forEach>
				</h:panelGrid>
			</h:panelGrid>
			<!-- middle column -->

			<h:panelGroup />

			<!-- right column -->
			<h:panelGrid columns="1" styleClass="defaultListingTableContainer">
				<h:panelGrid columns="2" styleClass="defaultListingTable">
					<!-- contact -->
					<h:outputLabel value="#{msg['body.receiptlog.notification']}"
						styleClass="big-text" />
					<h:panelGrid columns="3" style="float: right">
						<!-- quickContact surgeon -->
						<p:commandLink
							title="#{msg['body.receiptlog.notification.surgeon.hint']}"
							actionListener="#{dialogHandlerAction.contactSelectDialog.initAndPrepareBean(commonDataHandlerAction.selectedTask,'SURGEON')}">
							<i class="fa fa-fw fa-scissors" />
							<p:ajax event="dialogReturn" update="navigationForm contentForm" />
						</p:commandLink>

						<!-- quickcontact private physician  -->
						<p:commandLink
							title="#{msg['body.receiptlog.notification.ophthalmologist.hint']}"
							actionListener="#{dialogHandlerAction.contactSelectDialog.initAndPrepareBean(commonDataHandlerAction.selectedTask,'PRIVATE_PHYSICIAN')}">
							<i class="fa fa-fw fa-eye" />
							<p:ajax event="dialogReturn" update="navigationForm contentForm" />
						</p:commandLink>

						<!-- edit contacts -->
						<p:commandLink title="#{msg['body.receiptlog.notification.hint']}"
							actionListener="#{dialogHandlerAction.contactDialog.initAndPrepareBean(commonDataHandlerAction.selectedTask)}">
							<i class="fa fa-fw fa-cog" />
							<p:ajax event="dialogReturn" update="navigationForm contentForm" />
						</p:commandLink>
					</h:panelGrid>
				</h:panelGrid>

				<p:dataTable var="contact" scrollable="true" scrollHeight="90"
					style="width:350px"
					styleClass="smallDatatable highlightedDataTable noBordersAll"
					value="#{commonDataHandlerAction.selectedTask.contacts}">

					<p:column>
						<f:facet name="header">
							<h:outputLabel value="#{msg['body.receiptlog.contact.name']}" />
						</f:facet>
						<h:outputLabel value="#{contact.person.fullName}" />
					</p:column>

					<p:column headerText="">
						<f:facet name="header">
							<h:outputLabel value="#{msg['body.receiptlog.contact.role']}" />
						</f:facet>
						<h:outputLabel
							value="#{msg['enum.contactRole.'.concat(contact.role)]}"
							title="#{msg['enum.contactRole.'.concat(contact.role)]}">
							<f:converter converterId="org.histo.ui.TruncateConverter" />
							<f:attribute name="truncateAt" value="15" />
							<f:attribute name="continuationMark" value="..." />
						</h:outputLabel>
					</p:column>

					<p:column style="width:15px">
						<f:facet name="header">
							<i class="fa fa-check-square-o"
								title="#{msg['body.receiptlog.contact.type.performed']}" />
						</f:facet>
						<ui:fragment rendered="#{contact.notificationPerformed}">
							<i class="fa fa-check icon-green" />
						</ui:fragment>
					</p:column>
				</p:dataTable>
			</h:panelGrid>
			<!-- right column -->
		</h:panelGrid>

		<!-- Slides -->
		<h:panelGrid columns="1" styleClass="defaultListingTable">
			<!-- healinse -->
			<h:panelGroup>
				<h:outputLabel value="#{msg['body.receiptlog.slide.name']}"
					style="font-size:1.2em !important;"></h:outputLabel>
				<!-- staining completed -->
				<h:panelGroup
					rendered="#{taskStatusHandler.isStainingCompleted(commonDataHandlerAction.selectedTask)}">
					<div class="fa fa-check-circle icon-green"
						title="#{msg['body.receiptlog.slide.completed']}" />
				</h:panelGroup>
				<!-- staining to perform -->
				<h:panelGroup
					rendered="#{!taskStatusHandler.isStainingCompleted(commonDataHandlerAction.selectedTask) and !taskStatusHandler.isReStainingFlag(commonDataHandlerAction.selectedTask)}">
					<div class="fa fa-exclamation-circle icon-orange"
						title="#{msg['body.receiptlog.slide.staining']}" />
				</h:panelGroup>
				<!-- restaining to perform -->
				<h:panelGroup
					rendered="#{!taskStatusHandler.isStainingCompleted(commonDataHandlerAction.selectedTask) and taskStatusHandler.isReStainingFlag(commonDataHandlerAction.selectedTask)}">
					<div class="fa fa-exclamation-circle ic-custom icon-orange"
						title="#{msg['body.receiptlog.slide.restaining']}" />
				</h:panelGroup>
			</h:panelGroup>


			<!-- ******************************** Slides ******************************** -->
			<p:dataTable var="stainingRow" styleClass="stainingTable"
				value="#{commonDataHandlerAction.selectedTask.stainingTableRows}"
				rowIndexVar="index">

				<!-- sample -->
				<p:column
					styleClass="columnSample #{stainingRow.even ? 'datatable-odd' : ''}"
					headerText="#{msg['body.receiptlog.slide.headline.sample']}">
					<h:panelGroup rendered="#{stainingRow.sampleType}">

						<h:panelGroup layout="block" style="width: 90%; min-height:20px">
							<p:commandLink process="@this" update="contentForm"
								actionListener="#{commonDataHandlerAction.setSelectedStainingTableChooser(stainingRow)}"
								oncomplete="PF('idInputPannel').show('#{component.clientId}')">
								<h:outputLabel
									value="#{msg['body.receiptlog.slide.sample']} #{stainingRow.entity.sampleID}" />

								<h:panelGroup rendered="#{stainingRow.entity.idManuallyAltered}">
									<i class="fa fa-fw fa-chain"
										title="#{msg['body.statiningView.idManuallyAltered']}" />
								</h:panelGroup>
							</p:commandLink>
						</h:panelGroup>

					</h:panelGroup>
				</p:column>

				<!-- Block -->
				<p:column
					styleClass="columnBlock #{stainingRow.even ? 'datatable-odd' : ''}"
					headerText="#{msg['body.receiptlog.slide.headline.block']}">
					<h:panelGroup rendered="#{stainingRow.blockType}">
						<h:panelGroup layout="block" style="width: 90%; min-height:20px">
							<p:commandLink process="@this" update="contentForm"
								actionListener="#{commonDataHandlerAction.setSelectedStainingTableChooser(stainingRow)}"
								oncomplete="PF('idInputPannel').show('#{component.clientId}')">
								<h:outputLabel
									value="#{msg['body.receiptlog.slide.block']} #{stainingRow.entity.blockID}" />
								<h:panelGroup rendered="#{stainingRow.entity.idManuallyAltered}">
									<i class="fa fa-fw fa-chain"
										title="#{msg['body.statiningView.idManuallyAltered']}" />
								</h:panelGroup>
							</p:commandLink>
						</h:panelGroup>
					</h:panelGroup>
				</p:column>

				<!-- Staining chooser -->
				<p:column
					styleClass="columnChoose #{stainingRow.even ? 'datatable-odd' : ''}"
					headerText="">
					<h:panelGroup
						rendered="#{stainingRow.sampleType or stainingRow.blockType}">
						<p:commandLink
							actionListener="#{receiptlogViewHandlerAction.toggleChildrenChoosenFlag(stainingRow)}"
							update="contentForm"
							title="#{stainingRow.sampleType ? msg['body.statiningView.chooseSample'] : msg['body.statiningView.chooseBlock']}">
							<i class="fa fa-fw fa-check-circle" />
						</p:commandLink>
					</h:panelGroup>
					<h:panelGroup rendered="#{stainingRow.stainingType}">
						<p:selectBooleanCheckbox value="#{stainingRow.choosen}" />
					</h:panelGroup>
				</p:column>

				<!-- staining - name -->
				<p:column
					styleClass="columnStainingID #{stainingRow.even ? 'datatable-odd' : ''}"
					headerText="#{msg['body.receiptlog.slide.headline.staining.id']}">
					<h:panelGroup rendered="#{stainingRow.stainingType}">
						<h:panelGroup layout="block" style="width: 90%; min-height:20px">
							<p:commandLink process="@this" update="contentForm"
								actionListener="#{commonDataHandlerAction.setSelectedStainingTableChooser(stainingRow)}"
								oncomplete="PF('idInputPannel').show('#{component.clientId}')">
								<h:outputLabel value="#{stainingRow.entity.slideID}" />

								<h:panelGroup rendered="#{stainingRow.entity.idManuallyAltered}">
									<i class="fa fa-fw fa-chain"
										title="#{msg['body.statiningView.idManuallyAltered']}" />
								</h:panelGroup>
							</p:commandLink>
						</h:panelGroup>
					</h:panelGroup>
				</p:column>

				<!-- staining commentary -->
				<p:column
					styleClass="columnCommentary #{stainingRow.even ? 'datatable-odd' : ''}"
					headerText="#{msg['body.receiptlog.slide.headline.staining.commentary']}">
					<h:panelGroup rendered="#{stainingRow.stainingType}">
						<p:selectOneMenu styleClass="smallInput" style="width: 90%"
							value="#{stainingRow.entity.commentary}" editable="true"
							disabled="#{!taskEditable}">

							<f:selectItems
								value="#{receiptlogViewHandlerAction.slideCommentary}"
								var="commentary" itemLabel="#{commentary.value}"
								itemValue="#{commentary.value}" />

							<p:ajax event="change" execute="@this"
								listener="#{diagnosisViewHandlerAction.onDataChange(stainingRow.entity,'log.settings.staining.update')}" />
						</p:selectOneMenu>

					</h:panelGroup>
				</p:column>

				<!-- Staining staining -->
				<p:column
					styleClass="columnStaining #{stainingRow.even ? 'datatable-odd' : ''}"
					headerText="#{msg['body.receiptlog.slide.headline.staining.staining']}">
					<h:panelGroup rendered="#{stainingRow.stainingType}">
						<h:outputText value="#{stainingRow.entity.slidePrototype.name}" />
					</h:panelGroup>
				</p:column>

				<!-- Staining status -->
				<p:column
					styleClass="columnStatus #{stainingRow.even ? 'datatable-odd' : ''}">
					<!-- Sample status -->
					<h:panelGroup rendered="#{stainingRow.sampleType}">
						<!-- ********** Staining performed ********** -->
						<h:panelGroup
							rendered="#{taskStatusHandler.isStainingCompleted(stainingRow.entity)}">
							<i class="fa fa-fw fa-check-circle icon-green"
								title="#{msg['body.statiningView.status.performed']}" />
						</h:panelGroup>
					</h:panelGroup>
					<!-- Block status -->
					<h:panelGroup rendered="#{stainingRow.blockType}">
						<!-- ********** Staining performed ********** -->
						<h:panelGroup
							rendered="#{taskStatusHandler.isStainingCompleted(stainingRow.entity)}">
							<i class="fa fa-fw fa-check-circle icon-green"
								title="#{msg['body.statiningView.status.performed']}" />
						</h:panelGroup>
					</h:panelGroup>

					<!-- Slide status -->
					<h:panelGroup rendered="#{stainingRow.stainingType}">
						<!-- ********** Staining performed ********** -->
						<h:panelGroup rendered="#{stainingRow.entity.stainingCompleted}">
							<i class="fa fa-fw fa-check-circle icon-green"
								title="#{msg['body.statiningView.status.performed']}" />
						</h:panelGroup>

						<h:panelGroup rendered="#{stainingRow.entity.reStaining}">
							<i class="fa fa-fw fa-th-list icon-orange"
								title="#{msg['body.statiningView.status.restaining']}" />
						</h:panelGroup>
					</h:panelGroup>
				</p:column>

				<!-- Options -->
				<p:column
					styleClass="columnOptions #{stainingRow.even ? 'datatable-odd' : ''}">
					<f:facet name="header">
						<h:outputLabel
							value="#{msg['body.receiptlog.slide.headline.options']}"></h:outputLabel>
						<p:commandLink styleClass="noUnderlineAtLink"
							id="quickTaskSettings"
							actionListener="#{slideNamingDialog.initAndPrepareBean(commonDataHandlerAction.selectedTask)}">
							<i class="fa fa-wrench" />
							<p:ajax event="dialogReturn" update="navigationForm contentForm" />
						</p:commandLink>
					</f:facet>
					<!-- Sample -->
					<h:panelGroup rendered="#{stainingRow.sampleType}"
						style="float: right">
						<!-- ********** New Block Button ********** -->
						<p:commandLink title="#{msg['body.statiningView.newBlock']}"
							styleClass="noUnderlineAtLink" disabled="#{!taskEditable}"
							update="navigationForm contentForm"
							actionListener="#{diagnosisViewHandlerAction.createNewBlock(stainingRow.entity)}">
							<i class="fa fa-fw fa-th-large"></i>
						</p:commandLink>
						<!-- ********** Delete Button ********** -->
						<p:commandLink styleClass="noUnderlineAtLink"
							title="#{msg['body.statiningView.archiveSample']}"
							disabled="#{!taskEditable}"
							actionListener="#{deleteTaskEntityDialog.initAndPrepareBean(stainingRow.entity.task,stainingRow.entity)}">
							<i class="fa fa-fw fa-times-circle"></i>
							<p:ajax event="dialogReturn" update="navigationForm contentForm" />
						</p:commandLink>
					</h:panelGroup>

					<!-- Block -->
					<h:panelGroup rendered="#{stainingRow.blockType}"
						style="float: right">
						<!-- ********** New Staining Button ********** -->
						<p:commandLink title="#{msg['body.statiningView.newStaining']}"
							styleClass="noUnderlineAtLink" disabled="#{!taskEditable}"
							actionListener="#{addSlidesDialogHandler.initAndPrepareBean(stainingRow.entity)}">
							<i class="fa fa-fw fa-paint-brush"></i>
							<p:ajax event="dialogReturn" update="navigationForm contentForm" />
						</p:commandLink>
						<!-- ********** Delete Button ********** -->
						<p:commandLink styleClass="noUnderlineAtLink"
							disabled="#{!taskEditable}"
							title="#{msg['body.statiningView.archiveBlock']}"
							actionListener="#{deleteTaskEntityDialog.initAndPrepareBean(stainingRow.entity.task,stainingRow.entity)}">
							<i class="fa fa-fw fa-times-circle"></i>
							<p:ajax event="dialogReturn" update="navigationForm contentForm" />
						</p:commandLink>
					</h:panelGroup>

					<!-- Staining -->
					<h:panelGroup rendered="#{stainingRow.stainingType}"
						style="float: right">
						<!-- ********** Print Button ********** -->
						<p:commandLink styleClass="noUnderlineAtLink"
							actionListener="#{receiptlogViewHandlerAction.printLableForSlide(stainingRow.entity)}"
							title="#{msg['body.statiningView.printStaining']}">
							<i class="fa fa-fw fa-print" />
							<p:ajax event="dialogReturn" update="navigationForm contentForm" />
						</p:commandLink>
						<!-- ********** Cloud Button ********** -->
						<p:commandLink styleClass="noUnderlineAtLink"
							title="#{msg['body.statiningView.showStaining']}">
							<i class="fa fa-fw fa-file-photo-o" />
							<p:ajax event="dialogReturn" update="navigationForm contentForm" />
						</p:commandLink>
						<!-- ********** Delete Button ********** -->
						<p:commandLink styleClass="noUnderlineAtLink"
							disabled="#{!taskEditable}"
							title="#{msg['body.statiningView.archiveStaining']}"
							actionListener="#{deleteTaskEntityDialog.initAndPrepareBean(stainingRow.entity.task,stainingRow.entity)}">
							<i class="fa fa-fw fa-times-circle" />
							<p:ajax event="dialogReturn" update="navigationForm contentForm" />
						</p:commandLink>
					</h:panelGroup>
				</p:column>
			</p:dataTable>

			<p:overlayPanel id="idInputPannel" onHide="saveNameChange()"
				styleClass="defaultOverlayPanel" widgetVar="idInputPannel"
				hideEffect="fade" hideEvent="none" showEvent="none">
				<p:inputText id="idInputPannelInput" disabled="#{!taskEditable}"
					rendered="#{commonDataHandlerAction.selectedStainingTableChooser ne null}"
					value="#{commonDataHandlerAction.selectedStainingTableChooser.IDText}" />
			</p:overlayPanel>

			<p:remoteCommand
				actionListener="#{receiptlogViewHandlerAction.onEntityIDAlteredOverlayClose(commonDataHandlerAction.selectedStainingTableChooser)}"
				name="saveNameChange" update="navigationForm contentForm" />

			<h:panelGrid columns="5" style="margin-top:10px;">

				<!-- New sample -->
				<p:commandButton icon="fa fa-fw fa-plus-circle"
					styleClass="taskButton" disabled="#{!taskEditable}"
					value="#{msg['body.statiningView.newSample']}"
					actionListener="#{createSampleDialog.initAndPrepareBean(commonDataHandlerAction.selectedTask)}">
					<p:ajax event="dialogReturn" update="navigationForm contentForm" />
				</p:commandButton>

				<p:commandButton icon="fa fa-fw fa-check-circle"
					disabled="#{!taskEditable}" update="contentForm"
					value="#{msg['body.statiningView.chooseAll']}"
					actionListener="#{receiptlogViewHandlerAction.setListAsChoosen(commonDataHandlerAction.selectedTask.stainingTableRows,true)}" />

				<h:outputLabel value="#{msg['body.statiningView.choosenElements']}"
					style="margin-left:20px;"></h:outputLabel>
				<h:panelGroup>
					<p:selectOneMenu
						value="#{receiptlogViewHandlerAction.actionOnMany}"
						disabled="#{!taskEditable}"
						onchange="PF('performOnMay').jq.click();">

						<f:selectItems value="#{enumProvider.stainingListActions}"
							var="action"
							itemLabel="#{msg['enum.stainingListAction.'.concat(action)]}" />

					</p:selectOneMenu>

					<p:commandButton id="changeZone" widgetVar="performOnMay"
						style="display:none;"
						update="navigationForm contentForm headerForm"
						actionListener="#{receiptlogViewHandlerAction.performActionOnMany(commonDataHandlerAction.selectedTask)}">
						<p:ajax event="dialogReturn"
							update="navigationForm contentForm headerForm" />
					</p:commandButton>
				</h:panelGroup>
			</h:panelGrid>
			<!-- ******************************** Slides ******************************** -->
		</h:panelGrid>
	</p:panel>

</ui:composition>
