<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://java.sun.com/jsp/jstl/core">

	<ui:include src="common/navigationBar.xhtml"></ui:include>

	<p:panel style="width:100%;"
		styleClass=" collapsedBorders noPadding noBorders">

		<!-- Task -->
		<h:panelGroup styleClass="contentHolder" layout="block"
			style="padding:5px; width:auto">
			<p:panelGrid styleClass="noBorders" style="border: 1px solid black;">
				<p:row styleClass="noBorders">
					<!-- Receipt Date -->
					<p:column>
						<h:outputLabel value="#{msg['body.receiptlog.taskEDate']}" />
					</p:column>
					<p:column>
						<p:calendar pattern="dd.MM.yyyy" mask="true" id="receiptDate"
							value="#{worklistHandlerAction.selectedPatient.selectedTask.dateOfReceiptAsDate}">
							<p:ajax event="dateSelect"
								listener="#{taskHandlerAction.taskDataChanged(worklistHandlerAction.selectedPatient.selectedTask,'log.patient.task.dataChange.receiptDate',mainHandlerAction.date(worklistHandlerAction.selectedPatient.selectedTask.dateOfReceiptAsDate))}"
								update="receiptDate" />
							<f:ajax event="change" execute="@this" render="receiptDate"
								listener="#{taskHandlerAction.taskDataChanged(worklistHandlerAction.selectedPatient.selectedTask,'log.patient.task.dataChange.receiptDate',mainHandlerAction.date(worklistHandlerAction.selectedPatient.selectedTask.dateOfReceiptAsDate))}" />
						</p:calendar>
					</p:column>

					<!-- Termin Date -->
					<p:column>
						<h:outputLabel value="#{msg['body.receiptlog.taskDueDate']}" />
					</p:column>
					<p:column>
						<h:panelGrid columns="2" styleClass="collapsedBorders noPadding">
							<p:selectBooleanCheckbox style="padding-right:5px;"
								title="#{msg['body.receiptlog.taskDueDate.hint']}"
								value="#{worklistHandlerAction.selectedPatient.selectedTask.dueDateSelected}">
								<p:ajax event="change" execute="@this"
									update="navigationForm contentForm"
									listener="#{taskHandlerAction.taskDataChanged(worklistHandlerAction.selectedPatient.selectedTask,'log.patient.task.dataChange.dueDate',worklistHandlerAction.selectedPatient.selectedTask.dueDateSelected)}">
								</p:ajax>
							</p:selectBooleanCheckbox>
							<p:calendar pattern="dd.MM.yyyy" mask="true" id="dueDate"
								value="#{worklistHandlerAction.selectedPatient.selectedTask.dueDateAsDate}"
								disabled="#{!worklistHandlerAction.selectedPatient.selectedTask.dueDateSelected}">
								<p:ajax event="dateSelect"
									listener="#{taskHandlerAction.taskDataChanged(worklistHandlerAction.selectedPatient.selectedTask,'log.patient.task.dataChange.dueDate.date',mainHandlerAction.date(worklistHandlerAction.selectedPatient.selectedTask.dueDateAsDate))}"
									update="dueDate" />
								<f:ajax event="change" execute="@this" render="dueDate"
									listener="#{taskHandlerAction.taskDataChanged(worklistHandlerAction.selectedPatient.selectedTask,'log.patient.task.dataChange.dueDate.date',mainHandlerAction.date(worklistHandlerAction.selectedPatient.selectedTask.dueDateAsDate))}" />
							</p:calendar>
						</h:panelGrid>
					</p:column>

					<!-- contact -->
					<p:column>
						<h:outputLabel value="#{msg['body.receiptlog.notification']}"></h:outputLabel>

						<p:commandLink title="#{msg['body.receiptlog.notification.hint']}"
							style="float: right"
							actionListener="#{contactHandlerAction.showContacts(worklistHandlerAction.selectedPatient.selectedTask)}">
							<i class="fa fa-fw fa-cog" />
							<p:ajax event="dialogReturn" update="navigationForm contentForm" />
						</p:commandLink>
					</p:column>
				</p:row>

				<p:row styleClass="noBorders">
					<!-- ward -->
					<p:column>
						<p:outputLabel value="#{msg['body.receiptlog.ward']}" />
					</p:column>
					<p:column>
						<p:selectOneMenu styleClass="taskSelectOnMenu" editable="true"
							value="#{worklistHandlerAction.selectedPatient.selectedTask.ward}">
							<f:selectItem itemLabel="#{msg['body.receiptlog.ward.select']}"
								itemValue="none" />
							<f:selectItem itemLabel="#{msg['body.receiptlog.ward.ambulant']}"
								itemValue="ambulant" />
							<f:selectItem
								itemLabel="#{msg['body.receiptlog.ward.inpatient']}"
								itemValue="impatient" />
							<f:selectItem
								itemLabel="#{msg['body.receiptlog.ward.ambulant.private']}"
								itemValue="private" />
							<f:selectItem
								itemLabel="#{msg['body.receiptlog.ward.inpatient.private']}"
								itemValue="impatient-private" />
							<f:selectItem itemLabel="#{msg['body.receiptlog.ward.ims']}"
								itemValue="ims" />
							<f:selectItem itemLabel="#{msg['body.receiptlog.ward.extern']}"
								itemValue="extern" />
							<f:selectItem
								itemLabel="#{msg['body.receiptlog.ward.exern.private']}"
								itemValue="extern-private" />
							<f:selectItem itemLabel="#{msg['body.receiptlog.ward.fda']}"
								itemValue="fda" />
							<f:selectItem itemLabel="#{msg['body.receiptlog.ward.manz']}"
								itemValue="manz" />
							<f:selectItem itemLabel="#{msg['body.receiptlog.ward.beck']}"
								itemValue="beck" />
							<f:selectItem itemLabel="#{msg['body.receiptlog.ward.axenfeld']}"
								itemValue="axenfeld" />

							<p:ajax event="change" execute="@this"
								listener="#{taskHandlerAction.taskDataChanged(worklistHandlerAction.selectedPatient.selectedTask,'log.patient.task.dataChange.ward',worklistHandlerAction.selectedPatient.selectedTask.ward)}" />

						</p:selectOneMenu>
					</p:column>

					<!-- material -->
					<p:column>
						<p:outputLabel value="#{msg['body.receiptlog.material']}" />
					</p:column>
					<p:column rowspan="2" styleClass="verticalAlignTopAll">
						<p:panelGrid columns="2"
							styleClass="noBordersAll collapsedBordersAll verticalAlignMiddleAll smallPaddingAll">
							<!-- TODO Update background object, e.g. .blure() (inputtext) -->
							<c:forEach
								items="#{worklistHandlerAction.selectedPatient.selectedTask.samples}"
								var="sample">
								<h:outputLabel value="#{sample.sampleID}" />
								<p:selectOneMenu value="#{sample.material}"
									styleClass="smallInput" editable="true" style="width:100px;">
									<f:selectItem
										itemLabel="#{msg['body.receiptlog.material.select']}"
										itemValue="none" />
									<f:selectItems
										value="#{taskHandlerAction.allAvailableMaterials}" var="list"
										itemLabel="#{list.name}" itemValue="#{list.name}" />

									<p:ajax event="change" execute="@this"
										listener="#{taskHandlerAction.taskDataChanged(worklistHandlerAction.selectedPatient.selectedTask,'log.patient.task.dataChange.sample.material',worklistHandlerAction.selectedPatient.selectedTask.taskID,sample.material.name)}" />
								</p:selectOneMenu>
							</c:forEach>
						</p:panelGrid>
					</p:column>

					<!-- contact -->
					<p:column rowspan="3" style="padding-top:0px;">
						<p:dataTable var="contact" scrollable="true" scrollHeight="90"
							styleClass="noBordersAll collapsedBordersAll addedContactDataTable"
							value="#{worklistHandlerAction.selectedPatient.selectedTask.contacts}">

							<p:column headerText="#{msg['body.receiptlog.contact.name']}">
								<h:outputText value="#{contact.physician.fullName}" />
							</p:column>

							<p:column headerText="#{msg['body.receiptlog.contact.role']}">
								<h:outputText
									value="#{msg['body.receiptlog.contact.role.surgeon']}"
									rendered="#{contact.role eq 'SURGEON'}" />
								<h:outputText
									value="#{msg['body.receiptlog.contact.role.privatePhysician']}"
									rendered="#{contact.role eq 'PRIVATE_PHYSICIAN'}" />
								<h:outputText
									value="#{msg['body.receiptlog.contact.role.other']}"
									rendered="#{contact.role eq 'OTHER'}" />
							</p:column>

							<p:column>
								<f:facet name="header">
									<i class="fa fa-check-square-o"
										title="#{msg['body.receiptlog.contact.type.performed']}" />
								</f:facet>
								<ui:fragment rendered="#{contact.notificationPerformed}">
									<i class="fa fa-check icon-green" />
								</ui:fragment>
							</p:column>
						</p:dataTable>
					</p:column>
				</p:row>

				<!-- story -->
				<p:row styleClass="noBorders">
					<p:column>
						<h:outputLabel value="#{msg['body.receiptlog.story']}" />
					</p:column>
					<p:column>
						<p:inputTextarea rows="2" cols="22" id="stroyField"
							value="#{worklistHandlerAction.selectedPatient.selectedTask.caseHistory}">
							<p:ajax event="change" execute="@this"
								listener="#{taskHandlerAction.taskDataChanged(worklistHandlerAction.selectedPatient.selectedTask,'log.patient.task.dataChange.caseHistory',worklistHandlerAction.selectedPatient.selectedTask.caseHistory)}" />
						</p:inputTextarea>
						<p:watermark value="#{msg['body.receiptlog.story.watermark']}"
							for="stroyField" />
					</p:column>
				</p:row>

				<p:row styleClass="noBorders">
					<!-- eye -->
					<p:column>
						<h:outputLabel value="#{msg['body.receiptlog.eye']}" />
					</p:column>
					<p:column>
						<p:selectOneMenu styleClass="smallInput"
							value="#{worklistHandlerAction.selectedPatient.selectedTask.eye}">

							<f:selectItems value="#{enumProvider.eyes}" var="eye"
								itemLabel="#{msg['enum.eye.'.concat(eye)]}" itemValue="#{eye}" />

							<p:ajax event="change" execute="@this"
								listener="#{taskHandlerAction.taskDataChanged(worklistHandlerAction.selectedPatient.selectedTask,'log.patient.task.dataChange.eye',msg['enum.eye.'.concat(worklistHandlerAction.selectedPatient.selectedTask.eye)])}" />
						</p:selectOneMenu>
					</p:column>

					<!-- other -->
					<p:column>
						<h:outputLabel value="#{msg['body.receiptlog.miscellaneous']}" />
					</p:column>
					<p:column>
						<p:commandButton icon="fa fa-fw fa-taxi"
							title="#{msg['body.receiptlog.miscellaneous.borrow']}" />
						<p:commandButton icon="fa fa-fw fa-dollar"
							actionListener="#{mainHandlerAction.showDialog(enumProvider.getDialog('WORKLIST_ACCOUNTING'))}"
							title="#{msg['body.receiptlog.miscellaneous.accounting']}" />
					</p:column>
				</p:row>

				<p:row styleClass="noBorders">
					<p:column colspan="6">
						<p:tabView styleClass="tabView">
							<!-- ******************************** Diagnosis ******************************** -->
							<p:tab title="Diagnose" id="diagnosisTab">

								<!-- Diagnosis -->
								<f:facet name="title">

									<h:outputLabel
										value="#{msg['body.receiptlog.tab.diangonsis.title']}" />

									<!-- diagnosis completed -->
									<h:panelGroup
										rendered="#{worklistHandlerAction.selectedPatient.selectedTask.diagnosisCompleted}">
										<div class="fa fa-check-circle icon-green"
											title="#{msg['body.receiptlog.tab.diangonsis.status.completed.hint']}" />
									</h:panelGroup>

									<!-- diagnosis not completed -->
									<h:panelGroup
										rendered="#{!worklistHandlerAction.selectedPatient.selectedTask.diagnosisCompleted and worklistHandlerAction.selectedPatient.selectedTask.stainingCompleted}">
										<div class="fa fa-exclamation-circle icon-orange"
											title="#{msg['body.receiptlog.tab.diangonsis.status.notcompleted.hint']}" />
									</h:panelGroup>
								</f:facet>


								<p:panelGrid styleClass="stainingTable">
									<ui:repeat
										value="#{worklistHandlerAction.selectedPatient.selectedTask.samples}"
										var="sample">
										<!-- Diangosis -->
										<p:row>
											<p:column styleClass="columnSample"
												style="vertical-align:top;">
												<p:panelGrid columns="1">
													<h:outputLabel
														value="#{msg['body.receiptlog.tab.diangonsis.sample']} #{sample.sampleID}" />

													<!-- add diagnosis revision -->
													<p:commandLink
														rendered="#{diagnosisHandlerAction.isDiagonsisRevisionCreationPossible(sample)}"
														title="Diagnoserevision erstellen"
														actionListener="#{diagnosisHandlerAction.createDiagnosisFromGui(sample,'DIAGNOSIS_REVISION')}"
														update="contentForm">
														<h:outputLabel
															value="(#{msg['body.receiptlog.tab.diangonsis.link.revision']})"
															style="font-size:10px; margin-left: 10px;" />
													</p:commandLink>
												</p:panelGrid>
											</p:column>
											<p:column>

												<ui:repeat value="#{sample.diagnoses}" var="diagnosis"
													varStatus="loop">
													<p:panel id="toggleable" toggleable="true"
														collapsed="#{diagnosis.finalized}" toggleSpeed="500"
														style="margin-bottom:10px">

														<f:facet name="header">
															<p:inplace id="ajax" editor="true"
																styleClass="smallInput">
																<p:inputText value="#{diagnosis.name}" required="true"
																	label="text">
																	<f:ajax event="change" execute="@this"
																		listener="#{diagnosisHandlerAction.diagnosisDataChanged(diagnosis,'log.patient.task.sample.diagnosis.changed.name',diagnosis.name)}" />
																</p:inputText>
															</p:inplace>

															<!-- diangosis in headline -->
															<h:outputLabel value="(#{diagnosis.diagnosis})"
																rendered="#{diagnosis.diagnosis ne null and diagnosis.diagnosis.length() gt 0}" />

															<!-- finalized -->
															<h:outputLabel
																value="(#{msg['body.receiptlog.tab.diangonsis.data.headline.finalized']})"
																rendered="#{diagnosis.finalized}" />
														</f:facet>

														<!-- Body for diagnosis -->
														<h:panelGrid columns="1" style="width:100%;"
															id="diagnosisTable">
															<!-- choose diagnosis -->
															<h:panelGrid columns="3" style="width:90%;">
																<!-- choose diagnosis -->
																<h:panelGrid columns="2">
																	<h:outputLabel
																		value="#{msg['body.receiptlog.tab.diangonsis.data.diangosis']}" />
																	<p:selectOneMenu
																		value="#{diagnosis.diagnosisPrototype}"
																		disabled="#{diagnosis.finalized}"
																		converter="#{settingsHandlerAction.diagnosisPrototypeListTransformer}">
																		<f:selectItem
																			itemLabel="#{msg['body.receiptlog.tab.diangonsis.data.diangosis.choose']}"
																			itemValue="#{null}" />
																		<f:selectItems
																			value="#{settingsHandlerAction.allAvailableDiagnosisPrototypes}"
																			var="diagnosisPrototype"
																			itemLabel="#{diagnosisPrototype.name}"
																			itemValue="#{diagnosisPrototype}" />

																		<p:ajax event="change"
																			listener="#{diagnosis.updateDiagnosisWithPrest(diagnosis.diagnosisPrototype)}" />
																		<p:ajax event="change" update="diagnosisTable"
																			listener="#{diagnosisHandlerAction.diagnosisDataChanged(diagnosis,'log.patient.task.sample.diagnosis.changed.diagnosis',diagnosis.diagnosisPrototype.name)}" />

																	</p:selectOneMenu>
																</h:panelGrid>

																<h:panelGrid columns="2" style="float:right;">
																	<h:outputLabel
																		value="#{msg['body.receiptlog.tab.diangonsis.data.diangosis.reDiagnosis']}" />
																	<p:selectBooleanCheckbox
																		value="#{diagnosis.diagnosisRevision}"
																		style="margin:3px 0px 0px 3px;"
																		disabled="#{diagnosis.finalized}">

																		<p:ajax event="change" execute="@this"
																			update="diagnosisTable"
																			listener="#{diagnosisHandlerAction.diagnosisDataChanged(diagnosis,'log.patient.task.sample.diagnosis.changed.followUP',diagnosis.diagnosisRevision)}" />
																	</p:selectBooleanCheckbox>
																</h:panelGrid>
																<!-- malign -->
																<h:panelGrid columns="2" style="float:right;">
																	<h:outputLabel
																		value="#{msg['body.receiptlog.tab.diangonsis.data.diangosis.malign']}" />
																	<p:selectBooleanCheckbox value="#{diagnosis.malign}"
																		style="margin:3px 0px 0px 3px;"
																		disabled="#{diagnosis.finalized}">

																		<f:ajax event="change" execute="@this"
																			listener="#{diagnosisHandlerAction.diagnosisDataChanged(diagnosis,'log.patient.task.sample.diagnosis.changed.malign',diagnosis.malign)}" />
																	</p:selectBooleanCheckbox>
																</h:panelGrid>
															</h:panelGrid>

															<!-- diangosis text -->
															<p:inputTextarea value="#{diagnosis.diagnosis}" rows="2"
																style="width:90%" id="diagnosis"
																readonly="#{diagnosis.finalized}">
																<p:watermark for="diagnosis"
																	value="#{msg['body.receiptlog.tab.diangonsis.data.diangosis.watermark']}" />

																<f:ajax event="change" execute="@this"
																	listener="#{diagnosisHandlerAction.diagnosisDataChanged(diagnosis,'log.patient.task.sample.diagnosis.changed.diagnosis.text',diagnosis.diagnosis)}" />

															</p:inputTextarea>


															<h:panelGroup rendered="#{diagnosis.diagnosisRevision}">
																<!-- followup -->
																<p:inputTextarea
																	value="#{diagnosis.diagnosisRevisionText}" rows="2"
																	id="diagnosisFollowUp" style="width:90%"
																	readonly="#{diagnosis.finalized}">
																	<p:watermark for="diagnosisFollowUp"
																		value="#{msg['body.receiptlog.tab.diangonsis.data.diangosis.reDiagnosis.watermark']}" />
																	<f:ajax event="change" execute="@this"
																		listener="#{diagnosisHandlerAction.diagnosisDataChanged(diagnosis,'log.patient.task.sample.diagnosis.changed.followUp',diagnosis.diagnosisRevisionText)}" />
																</p:inputTextarea>
															</h:panelGroup>
														</h:panelGrid>

														<!-- Body for diagnosis -->
													</p:panel>
												</ui:repeat>
											</p:column>
										</p:row>
										<!-- Diangosis -->
									</ui:repeat>
								</p:panelGrid>
							</p:tab>
							<!-- ******************************** Diagnosis ******************************** -->



							<!-- ******************************** Staining ******************************** -->
							<p:tab>
								<!-- Sample -->
								<f:facet name="title">
									<!-- *********** Staining *********** -->
									<h:outputLabel value="#{msg['body.statiningView.tab.name']}" />
									<!-- staining completed -->
									<h:panelGroup
										rendered="#{worklistHandlerAction.selectedPatient.selectedTask.getStainingStatus() eq 'PERFORMED'}">
										<div class="fa fa-check-circle icon-green"
											title="#{msg['body.statiningView.tab.completed']}" />
									</h:panelGroup>
									<!-- staining to perform -->
									<h:panelGroup
										rendered="#{worklistHandlerAction.selectedPatient.selectedTask.getStainingStatus() eq 'STAINING_NEEDED'}">
										<div class="fa fa-exclamation-circle icon-orange"
											title="#{msg['body.statiningView.tab.staining']}" />
									</h:panelGroup>
									<!-- restaining to perform -->
									<h:panelGroup
										rendered="#{worklistHandlerAction.selectedPatient.selectedTask.getStainingStatus() eq 'RE_STAINING_NEEDED'}">
										<div class="fa fa-exclamation-circle ic-custom icon-orange"
											title="#{msg['body.statiningView.tab.restaining']}" />
									</h:panelGroup>
								</f:facet>

								<p:panelGrid styleClass="stainingTable">
									<f:facet name="header">
										<p:row>
											<p:column styleClass="columnSample">
												<h:outputLabel
													value="#{msg['body.statiningView.table.headline.sample']}"></h:outputLabel>
											</p:column>
											<p:column styleClass="columnBlock">
												<h:outputLabel
													value="#{msg['body.statiningView.table.headline.block']}"></h:outputLabel>
											</p:column>
											<p:column styleClass="columnChoose"></p:column>
											<p:column styleClass="columnStainingID">
												<h:outputLabel
													value="#{msg['body.statiningView.table.headline.staining.id']}"></h:outputLabel>
											</p:column>
											<p:column styleClass="columnStaining">
												<h:outputLabel
													value="#{msg['body.statiningView.table.headline.staining.staining']}"></h:outputLabel>
											</p:column>
											<p:column styleClass="columnStatus">
												<h:outputLabel
													value="#{msg['body.statiningView.table.headline.status']}"></h:outputLabel>
											</p:column>
											<p:column styleClass="columnOptions">
												<h:outputLabel
													value="#{msg['body.statiningView.table.headline.options']}"></h:outputLabel>
											</p:column>
										</p:row>
									</f:facet>

									<c:forEach
										items="#{worklistHandlerAction.selectedPatient.selectedTask.stainingTableRows}"
										var="stainingRow">
										<p:row>

											<!-- Sample -->
											<p:column
												styleClass="columnSample #{stainingRow.even ? 'darkBackround' : ''}">
												<h:panelGroup rendered="#{stainingRow.sampleType}">
													<h:outputLabel for="basic" value="Probe " />
													<p:inplace id="basic" styleClass="inplaceInput">
														<p:inputText value="#{stainingRow.sample.sampleID}" />
													</p:inplace>
												</h:panelGroup>
											</p:column>

											<!-- Block -->
											<p:column
												styleClass="columnBlock #{stainingRow.even ? 'darkBackround' : ''}">
												<h:panelGroup rendered="#{stainingRow.blockType}">
													<h:outputLabel for="block" value="Block "
														rendered="#{stainingRow.block ne null}" />
													<p:inplace id="block" styleClass="inplaceInput"
														rendered="#{stainingRow.block ne null}">
														<p:inputText value="#{stainingRow.block.blockID}"
															styleClass="inplaceInput" />
													</p:inplace>
												</h:panelGroup>
											</p:column>

											<!-- Staining chooser -->
											<p:column
												styleClass="columnChoose #{stainingRow.even ? 'darkBackround' : ''}">
												<h:panelGroup
													rendered="#{stainingRow.sampleType or stainingRow.blockType}">
													<p:commandLink
														actionListener="#{slideHandlerAction.toggleChildrenChoosenFlag(stainingRow)}"
														update="contentForm"
														title="#{stainingRow.sampleType ? msg['body.statiningView.chooseSample'] : msg['body.statiningView.chooseBlock']}">
														<i class="fa fa-fw fa-check-circle" />
													</p:commandLink>
												</h:panelGroup>
												<h:panelGroup rendered="#{stainingRow.stainingType}">
													<p:selectBooleanCheckbox value="#{stainingRow.choosen}" />
												</h:panelGroup>
											</p:column>

											<!-- Staining Name -->
											<p:column
												styleClass="columnStainingID #{stainingRow.even ? 'darkBackround' : ''}">
												<h:panelGroup rendered="#{stainingRow.stainingType}">
													<p:inplace styleClass="inplaceInput">
														<p:inputText value="#{stainingRow.staining.slideID}"
															style="width:100% !important;" />
													</p:inplace>
												</h:panelGroup>
											</p:column>

											<!-- Staining staining -->
											<p:column
												styleClass="columnStaining #{stainingRow.even ? 'darkBackround' : ''}">
												<h:panelGroup rendered="#{stainingRow.stainingType}">
													<h:outputText
														value="#{stainingRow.staining.slidePrototype.name}" />
												</h:panelGroup>
											</p:column>

											<!-- Staining status -->
											<p:column
												styleClass="columnStatus #{stainingRow.even ? 'darkBackround' : ''}">
												<!-- Sample status -->
												<h:panelGroup rendered="#{stainingRow.sampleType}">
													<!-- ********** Staining performed ********** -->
													<h:panelGroup
														rendered="#{stainingRow.sample.getStainingStatus() eq 'PERFORMED'}">
														<i class="fa fa-fw fa-check-circle icon-green"
															title="#{msg['body.statiningView.status.performed']}" />
													</h:panelGroup>
												</h:panelGroup>
												<!-- Block status -->
												<h:panelGroup rendered="#{stainingRow.blockType}">
													<!-- ********** Staining performed ********** -->
													<h:panelGroup
														rendered="#{stainingRow.block.getStainingStatus() eq 'PERFORMED'}">
														<i class="fa fa-fw fa-check-circle icon-green"
															title="#{msg['body.statiningView.status.performed']}" />
													</h:panelGroup>
												</h:panelGroup>

												<!-- Slide status -->
												<h:panelGroup rendered="#{stainingRow.stainingType}">
													<!-- ********** Staining performed ********** -->
													<h:panelGroup
														rendered="#{stainingRow.staining.stainingPerformed}">
														<i class="fa fa-fw fa-check-circle icon-green"
															title="#{msg['body.statiningView.status.performed']}" />
													</h:panelGroup>

													<h:panelGroup rendered="#{stainingRow.staining.reStaining}">
														<i class="fa fa-fw fa-th-list icon-orange"
															title="#{msg['body.statiningView.status.restaining']}" />
													</h:panelGroup>

													<!-- ********** Info Button ********** -->
													<p:commandLink id="info" type="button"
														styleClass="noUnderlineAtLink"
														title="#{stainingRow.staining.commentary}"
														rendered="#{stainingRow.staining.commentary ne ''}">
														<i class="fa fa-fw fa-info-circle" />
													</p:commandLink>
												</h:panelGroup>
											</p:column>

											<!-- Options -->
											<p:column
												styleClass="columnOptions #{stainingRow.even ? 'darkBackround' : ''}">
												<!-- Sample -->
												<h:panelGroup rendered="#{stainingRow.sampleType}"
													style="float: right">
													<!-- ********** New Block Button ********** -->
													<p:commandLink
														title="#{msg['body.statiningView.newBlock']}"
														styleClass="noUnderlineAtLink"
														update="navigationForm contentForm"
														actionListener="#{taskHandlerAction.createNewBlockFromGui(stainingRow.sample)}">
														<i class="fa fa-fw fa-th-large"></i>
													</p:commandLink>
													<!-- ********** Delete Button ********** -->
													<p:commandLink styleClass="noUnderlineAtLink"
														title="#{msg['body.statiningView.archiveSample']}"
														actionListener="#{mainHandlerAction.prepareArchiveObject(stainingRow.sample, true)}">
														<i class="fa fa-fw fa-times-circle"></i>
														<p:ajax event="dialogReturn"
															update="navigationForm contentForm" />
													</p:commandLink>
												</h:panelGroup>

												<!-- Block -->
												<h:panelGroup rendered="#{stainingRow.blockType}"
													style="float: right">
													<!-- ********** New Staining Button ********** -->
													<p:commandLink
														title="#{msg['body.statiningView.newStaining']}"
														styleClass="noUnderlineAtLink"
														actionListener="#{slideHandlerAction.prepareAddSlideDialog(stainingRow.block)}">
														<i class="fa fa-fw fa-paint-brush"></i>
														<p:ajax event="dialogReturn"
															update="navigationForm contentForm" />
													</p:commandLink>
													<!-- ********** Delete Button ********** -->
													<p:commandLink styleClass="noUnderlineAtLink"
														title="#{msg['body.statiningView.archiveBlock']}"
														actionListener="#{mainHandlerAction.prepareArchiveObject(stainingRow.block, true)}">
														<i class="fa fa-fw fa-times-circle"></i>
														<p:ajax event="dialogReturn"
															update="navigationForm contentForm" />
													</p:commandLink>
												</h:panelGroup>

												<!-- Staining -->
												<h:panelGroup rendered="#{stainingRow.stainingType}"
													style="float: right">
													<!-- ********** Print Button ********** -->
													<p:commandLink styleClass="noUnderlineAtLink"
														title="#{msg['body.statiningView.printStaining']}">
														<i class="fa fa-fw fa-print" />
														<p:ajax event="dialogReturn"
															update="navigationForm contentForm" />
													</p:commandLink>
													<!-- ********** Cloud Button ********** -->
													<p:commandLink styleClass="noUnderlineAtLink"
														title="#{msg['body.statiningView.showStaining']}">
														<i class="fa fa-fw fa-file-photo-o" />
														<p:ajax event="dialogReturn"
															update="navigationForm contentForm" />
													</p:commandLink>
													<!-- ********** Delete Button ********** -->
													<p:commandLink styleClass="noUnderlineAtLink"
														title="#{msg['body.statiningView.archiveStaining']}"
														actionListener="#{mainHandlerAction.prepareArchiveObject(stainingRow.staining, true)}">
														<i class="fa fa-fw fa-times-circle" />
														<p:ajax event="dialogReturn"
															update="navigationForm contentForm" />
													</p:commandLink>
												</h:panelGroup>
											</p:column>
										</p:row>
									</c:forEach>
								</p:panelGrid>

								<h:panelGrid columns="5" style="margin-top:10px;">

									<!-- New sample -->
									<p:commandButton icon="fa fa-fw fa-plus-circle"
										styleClass="taskButton"
										value="#{msg['body.statiningView.newSample']}"
										actionListener="#{taskHandlerAction.prepareNewSampleDialog(worklistHandlerAction.selectedPatient.selectedTask)}">
										<p:ajax event="dialogReturn"
											update="navigationForm contentForm" />
									</p:commandButton>

									<p:commandButton icon="fa fa-fw fa-check-circle"
										update="contentForm"
										value="#{msg['body.statiningView.chooseAll']}"
										actionListener="#{slideHandlerAction.setListAsChoosen(worklistHandlerAction.selectedPatient.selectedTask.stainingTableRows,true)}" />

									<h:outputLabel
										value="#{msg['body.statiningView.choosenElements']}"
										style="margin-left:20px;"></h:outputLabel>
									<h:panelGroup>
										<p:selectOneMenu value="#{slideHandlerAction.actionOnMany}"
											onchange="PF('performOnMay').jq.click();">

											<f:selectItems value="#{enumProvider.stainingListActions}"
												var="action"
												itemLabel="#{msg['enum.stainingListAction.'.concat(action)]}" />

											<p:ajax update="navigationForm contentForm" />
										</p:selectOneMenu>

										<p:commandButton id="changeZone" widgetVar="performOnMay"
											style="display:none;"
											actionListener="#{slideHandlerAction.performActionOnMany(worklistHandlerAction.selectedPatient.selectedTask)}">
										</p:commandButton>
									</h:panelGroup>
								</h:panelGrid>
							</p:tab>
							<!-- ******************************** Staining ******************************** -->
						</p:tabView>
					</p:column>
				</p:row>
			</p:panelGrid>
		</h:panelGroup>
	</p:panel>

</ui:composition>
