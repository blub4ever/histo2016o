<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://java.sun.com/jsp/jstl/core">
<h:body>

	<ui:composition template="template/layout.xhtml">

		<!-- Header -->
		<ui:define name="header">
			<ui:include src="worklist/header.xhtml" />
		</ui:define>

		<!-- Navigation -->
		<ui:define name="navigation">
			<ui:include src="worklist/patientList.xhtml"></ui:include>
		</ui:define>

		<ui:define name="content">

			<ui:include src="worklist/navigationBar.xhtml"></ui:include>

			<p:panel style="width:100%;"
				rendered="#{worklistHandlerAction.selectedPatient ne null}"
				styleClass=" collapsedBorders noPadding noBorders">

				<p:panelGrid columns="4" styleClass="noBordersAll"
					style="min-width:700px"
					columnClasses="patientTableTagRow,patientTableContentRow,patientTableTagRow,patientTableContentRow">

					<h:outputLabel value="#{msg['body.worklist.patient.piz']}"
						styleClass="bold-text" />
					<h:outputLabel value="#{worklistHandlerAction.selectedPatient.piz}" />

					<h:outputLabel value="" />
					<h:outputLabel value="" />

					<h:outputLabel value="#{msg['body.worklist.patient.name']}"
						styleClass="bold-text" />
					<h:outputLabel
						value="#{worklistHandlerAction.selectedPatient.person.name}#{worklistHandlerAction.selectedPatient.person.title ne '' ? ',' : ''} #{worklistHandlerAction.selectedPatient.person.title}" />

					<h:outputLabel value="#{msg['body.worklist.patient.surname']}"
						styleClass="bold-text" />
					<h:outputLabel
						value="#{worklistHandlerAction.selectedPatient.person.surname}" />

					<p:outputLabel value="#{msg['body.worklist.patient.street']}"
						styleClass="bold-text" />
					<p:outputLabel
						value="#{worklistHandlerAction.selectedPatient.person.street}" />

					<p:outputLabel value="#{msg['body.worklist.patient.birthday']}"
						styleClass="bold-text" />
					<p:outputLabel
						value="#{worklistHandlerAction.selectedPatient.person.birthday}" />

					<p:outputLabel value="#{msg['body.worklist.patient.postcode']}"
						styleClass="bold-text" />
					<p:outputLabel
						value="#{worklistHandlerAction.selectedPatient.person.postcode}" />

					<p:outputLabel value="#{msg['body.worklist.patient.town']}"
						styleClass="bold-text" />
					<p:outputLabel
						value=" #{worklistHandlerAction.selectedPatient.person.town}" />

					<p:outputLabel value="#{msg['body.worklist.patient.phone']}"
						styleClass="bold-text" />
					<p:outputLabel
						value="#{worklistHandlerAction.selectedPatient.person.phoneNumber}" />

					<p:outputLabel value="#{msg['body.worklist.patient.insurance']}"
						styleClass="bold-text" />
					<p:outputLabel
						value="#{worklistHandlerAction.selectedPatient.insurance}" />

					<p:outputLabel value="#{msg['body.worklist.patient.extern']}"
						styleClass="bold-text" />
					<h:panelGroup>
						<p:outputLabel
							value="#{worklistHandlerAction.selectedPatient.externalPatient ? msg['general.yes'] : msg['general.no']} &nbsp; " />
						<p:commandLink
							rendered="#{worklistHandlerAction.selectedPatient.externalPatient}"
							actionListener="#{patientHandlerAction.editExternalPatient(worklistHandlerAction.selectedPatient)}">
							<p:ajax event="dialogReturn" update="navigationForm contentForm" />
							<i class="fa fa-wrench"></i>
						</p:commandLink>
					</h:panelGroup>
				</p:panelGrid>

				<p:dataTable var="tasks" scrollable="true" scrollHeight="100"
					style="margin-top:20px;" id="taskList"
					value="#{worklistHandlerAction.selectedPatient.tasks}"
					selectionMode="single"
					styleClass="defaultDataTable noBordersAll collapsedBordersAll"
					rendered="#{worklistHandlerAction.selectedPatient != null}"
					selection="#{worklistHandlerAction.selectedPatient.selectedTask}"
					rowKey="#{tasks.id}">

					<p:ajax event="rowSelect"
						oncomplete="$('#contentForm\\:selectTaskBtn').click();" />

					<p:column>
						<f:facet name="header">
							<h:panelGrid columns="2" styleClass="collapsedBorders noPadding">
								<h:outputLabel value="Aufträge" style="float:left;"></h:outputLabel>
								<p:commandLink id="taskList"
									actionListener="#{taskHandlerAction.prepareNewTaskDialog()}">
									<p:ajax event="dialogReturn"
										update="navigationForm contentForm" />
									<i class="fa fa-plus" style="float: right"></i>

								</p:commandLink>
							</h:panelGrid>
						</f:facet>

						<h:outputText
							value="#{tasks.taskID} - #{helperHandlerAction.simpleDateFormatter(tasks.dateOfReceiptAsDate)}" />

						<h:panelGroup rendered="#{tasks.isNew()}">
							<h:outputText value=" ("></h:outputText>
							<h:outputText value="Neu" style="color:green;" />
							<h:outputText value=") "></h:outputText>
						</h:panelGroup>

						<h:panelGroup rendered="#{tasks.isStainingNeeded()}">
							<h:outputText value=" ("></h:outputText>
							<h:outputText value="Färben" style="color:orange;" />
							<h:outputText value=") "></h:outputText>
						</h:panelGroup>

						<h:panelGroup rendered="#{tasks.isReStainingNeeded()}">
							<h:outputText value=" ("></h:outputText>
							<h:outputText value="Nachfärben" style="color:blue;" />
							<h:outputText value=") "></h:outputText>
						</h:panelGroup>

						<h:panelGroup rendered="#{tasks.isDiagnosisNeeded()}">
							<h:outputText value=" ("></h:outputText>
							<h:outputText value="Befundung" style="color:purple;" />
							<h:outputText value=") "></h:outputText>
						</h:panelGroup>

						<h:panelGroup rendered="#{tasks.isReDiagnosisNeeded()}">
							<h:outputText value=" ("></h:outputText>
							<h:outputText value="Nachbefundung" style="color:red;" />
							<h:outputText value=")"></h:outputText>
						</h:panelGroup>
					</p:column>

				</p:dataTable>


				<p:commandButton id="selectTaskBtn" ajax="none"
					action="#{worklistHandlerAction.selectTask(worklistHandlerAction.selectedPatient.selectedTask)}"
					style="display:none" />
				<!-- Auftrag -->

			</p:panel>

		</ui:define>
	</ui:composition>



</h:body>
</html>
