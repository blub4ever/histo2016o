<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions">


<h:head>
	<title><h:outputFormat value="#{msg['dialog.print.headline']}" /></title>
	<h:outputStylesheet name="histo.css" value="histo.css" />
</h:head>


<h:body styleClass="defaultDialogLayout bigDialog">
	<h:form id="dialogContent">

		<div class="defaulDilaogHeaderDivWithBackground">
			<h:panelGrid style="width:100%;" columns="2"
				styleClass="noBordersAll noPaddingAll collapsedBordersAll">
				<h:outputLabel value="#{msg['dialog.print.headline']}" />
				<p:commandLink title="#{msg['general.close']}" style="float:right;"
					styleClass="noUnderlineAtLink"
					actionListener="#{printDialogHandler.hideDialog()}">
					<i class="fa fa-fw fa-times" />
				</p:commandLink>
			</h:panelGrid>
		</div>

		<div class="contentDiv">
			<h:panelGrid columns="3" styleClass="defaultListingTableContainer"
				columnClasses="defaultListingTableColumnTop defaultListingTableColumn30,">
				<!-- left column -->

				<h:panelGrid columns="1" styleClass="defaultListingTableContainer">
					<h:panelGrid columns="2" styleClass="defaultListingTableCssOneCol"
						columnClasses="defaultListingTableColumn20,">

						<!-- document type -->
						<h:outputLabel value="#{msg['dialog.print.document']}" />
						<p:selectOneMenu value="#{printDialogHandler.selectedTemplate}"
							style="width:90% !important;"
							converter="#{printDialogHandler.templateTransformer}"
							styleClass="customSerachSelectMenu">
							<f:selectItems value="#{printDialogHandler.templateList}"
								var="template" itemLabel="#{template.name}"
								itemValue="#{template}" />

							<p:ajax update="@form" event="change"
								onstart="PF('blockUIWidget').block()"
								oncomplete="PF('blockUIWidget').unblock()"
								listener="#{printDialogHandler.onChangePrintTemplate()}"></p:ajax>
						</p:selectOneMenu>

					</h:panelGrid>

					<!-- to -->
					<h:panelGrid columns="1" styleClass="defaultListingTableCssOneCol"
						style="margin-top:20px;">
						<h:outputLabel value="#{msg['dialog.print.addresses']}" />
						<p:dataTable var="chooser"
							value="#{printDialogHandler.contactList}">
							<!-- select -->
							<p:column headerText="#" style="width:18px;">
								<p:selectBooleanCheckbox value="#{chooser.selected}"
									styleClass="smallInput">
									<p:ajax event="change" process="@form"
										onstart="PF('blockUIWidget').block()"
										oncomplete="PF('blockUIWidget').unblock()"
										listener="#{printDialogHandler.onChooseContact()}"></p:ajax>
								</p:selectBooleanCheckbox>
							</p:column>

							<!-- count -->
							<p:column headerText="#{msg['dialog.print.count']}"
								style="width:30px;">
								<p:spinner value="#{chooser.copies}" styleClass="miniSpinner"
									min="1" max="9"></p:spinner>
							</p:column>

							<!-- role -->
							<p:column headerText="" styleClass="smallFont">
								<h:outputText
									value="#{msg['enum.contactRole.'.concat(chooser.contact.role)]}" />
							</p:column>

							<!-- name -->
							<p:column headerText="#{msg['dialog.print.name']}"
								styleClass="smallFont">
								<h:outputText value="#{chooser.contact.person.fullName}" />
							</p:column>

						</p:dataTable>
					</h:panelGrid>
				</h:panelGrid>

				<h:panelGroup />

				<!-- right column -->
				<h:panelGrid columns="1" styleClass="defaultListingTableContainer">

					<h:panelGroup id="pdfRender">
						<p:media player="pdf" value="#{printDialogHandler.pdfContent}"
							width="100%" rendered="#{printDialogHandler.renderPdf}"
							height="630px"></p:media>
					</h:panelGroup>
				</h:panelGrid>
			</h:panelGrid>
		</div>

		<div class="buttonContainer" style="width: 100% !important">
			<h:panelGrid columns="1" style="width:100%"
				styleClass="noBordersAll collapsedBordersAll noPaddingAll">

				<h:panelGrid columns="4" style="float:right;">
					<!-- print -->
					<p:commandButton value="Drucken" icon="fa fa-print"
						styleClass="smallButton buttonRighMarginInListExtended"
						onstart="PF('blockUIWidget').block()"
						oncomplete="PF('blockUIWidget').unblock()"
						actionListener="#{printDialogHandler.onPrintNewPdf()}"></p:commandButton>

					<!-- select printer -->
					<p:selectOneMenu styleClass="customSerachSelectMenu"
						panelStyleClass="customSerachSelectMenuPanel"
						converter="#{settingsHandler.printerListTransformer}"
						value="#{settingsHandler.selectedPrinter}" filter="true"
						filterMatchMode="contains" style="margin-right:10px">

						<f:selectItems value="#{settingsHandler.printerList}"
							var="printer" itemLabel="#{printer.name}" itemValue="#{printer}" />
					</p:selectOneMenu>

					<!-- download -->
					<p:commandButton value="Ã–ffnen" icon="fa fa-download" ajax="false"
						styleClass="smallButton buttonRighMarginInListExtended"
						actionListener="#{printDialogHandler.onDownloadPdf}">
						<p:fileDownload value="#{printDialogHandler.pdfContent}" />
					</p:commandButton>

					<!-- Abort button -->
					<p:commandButton value="#{msg['general.close']}" id="closeBtn"
						styleClass="smallButton buttonRighMarginInList"
						icon="fa fa-times-circle"
						actionListener="#{printDialogHandler.hideDialog()}" />
				</h:panelGrid>
			</h:panelGrid>
		</div>
		<ui:include src="../../template/blockUi.xhtml"></ui:include>
	</h:form>
</h:body>
</html>
