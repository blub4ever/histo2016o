<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui">

<h:head>
	<title>#{msg['dialog.addPatient.headline']}</title>
	<h:outputStylesheet name="histo.css" value="histo.css" />
</h:head>

<h:body styleClass="printDialog">
	<h:form>
		<div class="bodyDiv">
			<div class="contentDiv">

				<h:panelGrid>
					<p:selectOneButton value="#{pdfHandlerAction.printTab}">
						<f:selectItem itemLabel="Gespeichert (3)" itemValue="PDF_VIEW" />
						<f:selectItem itemLabel="Neu" itemValue="PRINT_VIEW" />
						<p:ajax update="contentDiv"
							listener="#{pdfHandlerAction.onChangePrintTab}"></p:ajax>
					</p:selectOneButton>
				</h:panelGrid>




				<h:panelGrid columns="2" columnClasses="settingsColumn,pdfColumn"
					styleClass="contentTable" id="contentDiv">

					<!-- PDF view -->
					<h:panelGrid rendered="#{pdfHandlerAction.printTab eq 'PDF_VIEW'}">
						<p:dataTable value="#{pdfHandlerAction.taskToPrint.attachedPdfs}"
							var="pdfs">
							<p:column headerText="Id">
								<h:outputText value="#{pdfs.id}" />
							</p:column>
						</p:dataTable>
					</h:panelGrid>
					<!-- PDF view -->

					<!-- PDF Print view -->
					<h:panelGroup
						rendered="#{pdfHandlerAction.printTab eq 'PRINT_VIEW'}">
						<!-- template and printer select -->
						<h:panelGrid columns="2">

							<!-- Template select -->
							<h:outputLabel value="Dokument" />
							<p:selectOneMenu value="#{pdfHandlerAction.selectedTemplate}"
								style="width:150px;"
								converter="#{pdfHandlerAction.templateTransformer}">
								<f:selectItems value="#{pdfHandlerAction.templates}"
									var="template" itemLabel="#{msg[template.name]}"
									itemValue="#{template}" />

								<p:ajax update="@form"
									listener="#{pdfHandlerAction.onChangeTemplate()}"></p:ajax>
							</p:selectOneMenu>

							<h:panelGroup style="height:15px;" layout="block" />
							<h:panelGroup style="height:15px;" layout="block" />

							<h:outputLabel value="Drucker" />
							<p:selectOneMenu style="width:150px;">
								<f:selectItem itemLabel="TODO" itemValue="0" />
							</p:selectOneMenu>

							<h:outputLabel value="Anzahl" />
							<p:spinner min="1" size="13" />

							<h:panelGroup style="height:15px;" layout="block" />
							<h:panelGroup style="height:15px;" layout="block" />
						</h:panelGrid>
						<!-- template and printer select -->

						<!-- Council  -->
						<h:panelGrid
							rendered="#{pdfHandlerAction.selectedTemplate.type eq 'COUNCIL'}">
							<p:commandButton value="Konsil bearbeiten" process="@form"
								rendered="#{pdfHandlerAction.renderPDF}"
								icon="fa fa-fw fa-user-plus">
							</p:commandButton>
						</h:panelGrid>
						<!-- Council  -->

						<h:panelGrid columns="2"
							rendered="#{pdfHandlerAction.selectedTemplate.type eq 'INTERNAL_EXTENDED'}">

							<h:outputLabel value="Datum" />
							<p:calendar pattern="dd.MM.yyyy" mask="true"
								disabled="#{worklistHandlerAction.selectedPatient.selectedTask.diagnosisCompleted}"
								value="#{worklistHandlerAction.selectedPatient.selectedTask.dateOfSugeryAsDate}">
								<p:ajax event="dateSelect"
									listener="#{taskHandlerAction.taskDataChanged(worklistHandlerAction.selectedPatient.selectedTask,'log.patient.task.dataChange.dateOfSurgery',mainHandlerAction.date(worklistHandlerAction.selectedPatient.selectedTask.dateOfSugeryAsDate))}" />
								<f:ajax event="change" execute="@this"
									listener="#{taskHandlerAction.taskDataChanged(worklistHandlerAction.selectedPatient.selectedTask,'log.patient.task.dataChange.dateOfSurgery',mainHandlerAction.date(worklistHandlerAction.selectedPatient.selectedTask.dateOfSugeryAsDate))}" />
							</p:calendar>



							<h:outputLabel value="Assistent" />
							<p:selectOneMenu editable="true" style="float:right; width:80%"
								value="#{worklistHandlerAction.selectedPatient.selectedTask.report.signatureLeft.role}"
								rendered="#{worklistHandlerAction.selectedPatient.selectedTask.report.signatureLeft ne null}">
								<f:selectItems value="#{enumProvider.signatureRoles}"
									var="signatureRole"
									itemLabel="#{msg['enum.signatureRole.'.concat(signatureRole)]}"
									itemValue="#{msg['enum.signatureRole.'.concat(signatureRole)]}" />
							</p:selectOneMenu>

							<h:outputLabel value="Oberarzt" />
							<h:panelGroup id="sigantureRightRole">
								<p:selectOneMenu editable="true" style="float:right; width:80%"
									value="#{worklistHandlerAction.selectedPatient.selectedTask.report.signatureRight.role}"
									rendered="#{worklistHandlerAction.selectedPatient.selectedTask.report.signatureRight ne null}">
									<f:selectItems value="#{enumProvider.signatureRoles}"
										var="signatureRole"
										itemLabel="#{msg['enum.signatureRole.'.concat(signatureRole)]}"
										itemValue="#{msg['enum.signatureRole.'.concat(signatureRole)]}" />
								</p:selectOneMenu>
							</h:panelGroup>

						</h:panelGrid>
					</h:panelGroup>
					<!-- PDF Print view -->

					<!-- PDF Render -->
					<h:panelGroup>
						<p:media player="pdf" id="testtest"
							value="#{pdfHandlerAction.pdfContent}" width="100%"
							rendered="#{pdfHandlerAction.renderPDF}" height="550px"></p:media>
						<!-- Council create  -->
						<h:panelGrid
							rendered="#{pdfHandlerAction.selectedTemplate.type eq 'COUNCIL' and !pdfHandlerAction.renderPDF}">
							<h:outputLabel value="Kein Konsil vorhanden, Konsil erstellen?" />
							<p:commandButton value="Konsil bearbeiten" process="@form"
								icon="fa fa-fw fa-user-plus">
							</p:commandButton>
						</h:panelGrid>
						<!-- Council create  -->

						<!-- external -->
						<h:panelGrid
							rendered="#{(pdfHandlerAction.selectedTemplate.type eq 'FAMILY_PHYSICIAN' or pdfHandlerAction.selectedTemplate.type eq 'PRIVATE_PHYSICIAN' ) and !pdfHandlerAction.renderPDF}">
							<h:outputLabel value="Kein Hausarzt ausgewähl!" rendered="#{pdfHandlerAction.selectedTemplate.type eq 'FAMILY_PHYSICIAN'}"/>
							<h:outputLabel value="Kein Facharzt ausgewähl!" rendered="#{pdfHandlerAction.selectedTemplate.type eq 'PRIVATE_PHYSICIAN'}"/>
							<p:commandButton value="Konsil bearbeiten" process="@form"
								icon="fa fa-fw fa-user-plus">
							</p:commandButton>
						</h:panelGrid>
						<!-- external -->

					</h:panelGroup>
					<!-- PDF Render -->
				</h:panelGrid>

			</div>

			<div class="bottomDiv">
				<h:panelGrid columns="2" style="width:100%"
					styleClass="noBordersAll collapsedBordersAll noPaddingAll">
					<h:panelGrid columns="2">
						<p:commandButton value="Öffnen" process="@form"
							icon="fa fa-fw fa-user-plus">
							<f:actionListener
								binding="#{patientHandlerAction.addNewExternalPatient(patientHandlerAction.tmpPatient)}" />
							<f:actionListener
								binding="#{worklistHandlerAction.addPatientToWorkList(patientHandlerAction.tmpPatient,true)}" />
							<f:actionListener
								binding="#{patientHandlerAction.clearTmpPatient()}" />
						</p:commandButton>
						<p:commandButton value="Drucken" process="@form"
							icon="fa fa-fw fa-user-plus">
							<f:actionListener
								binding="#{patientHandlerAction.addNewExternalPatient(patientHandlerAction.tmpPatient)}" />
							<f:actionListener
								binding="#{worklistHandlerAction.addPatientToWorkList(patientHandlerAction.tmpPatient,true)}" />
							<f:actionListener
								binding="#{patientHandlerAction.clearTmpPatient()}" />
						</p:commandButton>
					</h:panelGrid>
				</h:panelGrid>
			</div>
		</div>
	</h:form>
</h:body>
</html>