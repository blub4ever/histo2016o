<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui">

	<div class="contentDiv" id="contentDiv">

		<!-- Email table -->
		<p:panelGrid id="emailGrid"
			styleClass="noBordersAll collapsedBordersAll notificationTable"
			style="width:100%">

			<!--  email -->
			<p:row>
				<p:column>
					<h:outputText value="#{msg['dialog.notification.notifiy.email']}: " />
					<h:outputText
						value="#{notificationHandlerAction.useEmail ? msg['dialog.notification.notifiy.email.enabled'] : msg['dialog.notification.notifiy.email.disabled']}"
						styleClass="bold-text #{notificationHandlerAction.useEmail ? 'icon-green' : 'icon-red'}" />
				</p:column>
			</p:row>

			<!-- persons to notify -->
			<p:row rendered="#{notificationHandlerAction.useEmail}">
				<p:column>
					<p:dataTable var="emailNotification" styleClass="physicianList"
						value="#{notificationHandlerAction.notificationEmailList}">
						<!-- name -->
						<p:column
							headerText="#{msg['dialog.notification.notifiy.email.name']}">
							<h:outputText
								value="#{emailNotification.contact.physician.person.fullName}" />
						</p:column>
						<!-- status -->
						<p:column
							headerText="#{msg['dialog.notification.notifiy.email.status']}">
							<!-- No notification -->
							<h:outputLabel
								rendered="#{emailNotification.notificationAttachment eq 'NONE'}"
								value="#{msg['dialog.notification.notifiy.email.none']}" />
							<!-- notification successful -->
							<ui:fragment rendered="#{emailNotification.performed}">
								<i class="fa fa-check icon-green"
									title="#{msg['dialog.notification.notifiy.email.performed']}" />
							</ui:fragment>
							<!-- error oh notification -->
							<ui:fragment rendered="#{emailNotification.error}">
								<i class="fa fa-times icon-red"
									title="#{msg['dialog.notification.notifiy.email.error']}" />
							</ui:fragment>
						</p:column>
					</p:dataTable>
				</p:column>
			</p:row>
		</p:panelGrid>

		<!-- fax table -->
		<p:panelGrid
			styleClass="noBordersAll collapsedBordersAll notificationTable"
			style="width:100%">

			<!-- fax -->
			<p:row>
				<p:column>
					<h:outputText value="#{msg['dialog.notification.notifiy.fax']}: " />
					<h:outputText
						value="#{notificationHandlerAction.useFax ? msg['dialog.notification.notifiy.fax.enabled'] : msg['dialog.notification.notifiy.fax.disabled']}"
						styleClass="bold-text #{notificationHandlerAction.useFax ? 'icon-green' : 'icon-red'}" />
				</p:column>
			</p:row>

			<!-- persons to notify -->
			<p:row rendered="#{notificationHandlerAction.useFax}">
				<p:column>
					<p:dataTable var="faxNotification" styleClass="physicianList"
						value="#{notificationHandlerAction.notificationFaxList}">

						<!-- name -->
						<p:column
							headerText="#{msg['dialog.notification.notifiy.fax.name']}">
							<h:outputText
								value="#{faxNotification.contact.physician.person.fullName}" />
						</p:column>

						<!-- status -->
						<p:column
							headerText="#{msg['dialog.notification.notifiy.fax.status']}">
							<h:outputLabel
								rendered="#{faxNotification.notificationAttachment eq 'NONE'}"
								value="#{msg['dialog.notification.notifiy.fax.none']}" />
						</p:column>
					</p:dataTable>
				</p:column>
			</p:row>
		</p:panelGrid>

		<!-- phone table -->
		<p:panelGrid
			styleClass="noBordersAll collapsedBordersAll notificationTable"
			style="width:100%">

			<!-- phone -->
			<p:row>
				<p:column style="width:25%">
					<h:outputText value="#{msg['dialog.notification.notifiy.phone']}: " />
					<h:outputText
						value="#{notificationHandlerAction.usePhone ? msg['dialog.notification.notifiy.phone.enabled'] : msg['dialog.notification.notifiy.phone.disabled']}"
						styleClass="bold-text #{notificationHandlerAction.usePhone ? 'icon-green' : 'icon-red'}" />
				</p:column>
			</p:row>

			<!-- persons to notify -->
			<p:row rendered="#{notificationHandlerAction.usePhone}">
				<p:column>
					<p:dataTable var="phoneNotification" styleClass="physicianList"
						value="#{notificationHandlerAction.notificationPhoneList}">
						<!-- name -->
						<p:column
							headerText="#{msg['dialog.notification.notifiy.phone.name']}">
							<h:outputText
								value="#{phoneNotification.contact.physician.person.fullName}" />
						</p:column>

						<!-- status -->
						<p:column
							headerText="#{msg['dialog.notification.notifiy.phone.status']}">
							<h:outputLabel
								rendered="#{phoneNotification.notificationAttachment eq 'NONE'}"
								value="#{msg['dialog.notification.notifiy.phone.none']}" />
						</p:column>
					</p:dataTable>
				</p:column>
			</p:row>
		</p:panelGrid>

		<!-- updates the interface -->
		<p:poll interval="1" update="@form" widgetVar="currentTimePoller"
			autoStart="#{notificationHandlerAction.notificationRunning ? true: false}" />

	</div>

	<div class="buttonContainer">
		<h:panelGrid columns="2" style="width:100%"
			styleClass="noBordersAll collapsedBordersAll noPaddingAll">
			<h:panelGrid columns="3" style="float:right;">

				<!-- back button, render if notification was not performed -->
				<p:commandButton value="#{msg['general.back']}" update="@form"
					styleClass="smallButton buttonRighMarginInList"
					rendered="#{!notificationHandlerAction.notificationPerformed}"
					disabled="#{notificationHandlerAction.notificationRunning}"
					actionListener="#{notificationHandlerAction.setNotificationTab('PHONE')}" />

				<!-- performe notification button, render if notification was not performed -->
				<p:commandButton
					value="#{msg['dialog.notification.notifiy.perform']}"
					update="@form"
					disabled="#{notificationHandlerAction.notificationRunning}"
					rendered="#{!notificationHandlerAction.notificationPerformed}"
					styleClass="smallButton buttonRighMarginInListExtended"
					async="true" partialSubmit="true"
					onclick="performNotificationBtn();" />

				<!-- placeholder, render if notification was performed -->
				<h:panelGroup
					rendered="#{notificationHandlerAction.notificationPerformed}" />

				<!-- pirnt button, rendere if notification was performed -->
				<p:commandButton value="#{msg['dialog.notification.notifiy.print']}"
					ajax="false" update="@form"
					styleClass="smallButton buttonRighMarginInListExtended"
					icon="ui-icon-arrowthick-1-s"
					rendered="#{notificationHandlerAction.notificationPerformed}">
					<p:fileDownload value="#{pdfHandlerAction.pdfContent}" />
				</p:commandButton>

				<!-- close button -->
				<p:commandButton value="#{msg['general.close']}" 
					styleClass="smallButton buttonRighMarginInList"
					icon="fa fa-times-circle"
					rendered="#{notificationHandlerAction.notificationPerformed}"
					actionListener="#{notificationHandlerAction.hideNotificatonDialog()}" />

				<!-- abort button -->
				<p:commandButton value="#{msg['general.abort']}" 
					styleClass="smallButton buttonRighMarginInList"
					icon="fa fa-times-circle"
					disabled="#{notificationHandlerAction.notificationRunning}"
					rendered="#{!notificationHandlerAction.notificationPerformed}"
					actionListener="#{notificationHandlerAction.hideNotificatonDialog()}" />
			</h:panelGrid>
		</h:panelGrid>
		<p:remoteCommand name="performNotificationBtn"
			actionListener="#{notificationHandlerAction.performeNotification()}"
			async="true"></p:remoteCommand>
	</div>
</ui:composition>
