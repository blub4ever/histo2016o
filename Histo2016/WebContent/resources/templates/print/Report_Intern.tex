\documentclass{scrreprt}
\usepackage[ngerman]{babel}
\usepackage[utf8]{inputenc}
\usepackage{graphicx}
\usepackage{wallpaper}
\usepackage[absolute]{textpos}
\usepackage{tabularx} 
\usepackage[T1]{fontenc}
\usepackage{supertabular}
\usepackage[left=2cm,right=2cm,top=3cm,bottom=2cm]{geometry}
\usepackage{amssymb}
\usepackage{helvet} 
\usepackage{lipsum} 
\usepackage{longtable}
\usepackage{lastpage}
\usepackage{fancyhdr}
\usepackage{ifthen}
\usepackage{setspace}
\usepackage{everypage}

\renewcommand{\familydefault}{\sfdefault} 

% header
\pagestyle{fancy}

\AddEverypageHook{
   \ifthenelse{\value{page}=1}
     {\renewcommand{\headrulewidth}{0.0pt}}
     {\renewcommand{\headrulewidth}{0.4pt}}
}

% footer 
\cfoot{\thepage\ of \pageref{LastPage}}

\setcounter{secnumdepth}{0}





\begin{document}
%\ThisCenterWallPaper{1}{D:/latex/intern_v21.pdf}
\ThisCenterWallPaper{1}{background.pdf}
%
 \input{code128.tex}


\baselineskip10pt

\textblockorigin{0in}{0in}
\setlength{\TPHorizModule}{1mm}
\setlength{\TPVertModule}{1mm}


% pat block
{
\scriptsize
\begin{textblock}{100}(19, 8) 
\noindent $!patient.person.fullName\\
$!patient.person.street\\
$!patient.person.postcode $!patient.person.town\\
\X=.35mm        
\barheight=1cm 
\code{#if($patient.piz == "") 0 #else $!patient.piz #end}\\
$!patient.piz\\
\end{textblock}
}

% add block
{
\begin{textblock}{100}(22, 50) 
\setstretch{1.0}
\noindent 
\textbf{$!subject} \\\\
$!addressee.generatedAddressAsLatex\\

\end{textblock}
}

~\\
\vspace{5.0cm}\\
\noindent\makebox[\linewidth]{\rule{\linewidth}{0.4pt}}\\\\
{\huge Histologisches Gutachten} \\

{
	\centering 
	\renewcommand{\arraystretch}{0}
	\setlength{\tabcolsep}{.16667em}
	\begin{tabular}{p{0.53\linewidth}p{0.47\linewidth}}
	
		{
			\renewcommand{\arraystretch}{1}
			\begin{tabular}[t]{p{0.3\linewidth}p{0.67\linewidth}}
				
 				#foreach ($sample in $task.samples)
					#if( $foreach.index == 0 )
	   				 	Präperat & $!sample.getMaterial() \\
	   				#else
						~ & $!sample.getMaterial() \\	   				
	   				#end
				#end
 				
 				\\
 				
 				\multicolumn{2}{l}{Vorgeschichte, klinischer Befund und Fragestellung} \\
 				\huge $!task.eye &  {\includegraphics[scale=0.4]{augen.png}} \\
 				\multicolumn{2}{l}{$!task.caseHistory} 
			
			\end{tabular}
		} 
		& 
		{
			\renewcommand{\arraystretch}{1}
			\begin{tabular}[t]{p{0.46\linewidth}p{0.5\linewidth}}
				
				Eingangsdatum & $!task.dateOfReceipt \\
				Eingangsnummer & $!task.taskID \\
				~ & 
					\X=.30mm        % The width of code will be greater
					\barheight=1cm % the height will be smaller.
					\code{$!task.taskID} \\
				Versicherung &
					{
						\setlength{\tabcolsep}{0em}
						\begin{tabular}{c c c c }
						
						#if( !$patient.privateInsurance)
						$\boxtimes$
						#else
						$\Box$
						#end
						
						&~regulär~ & 
						
						#if($patient.privateInsurance)
						$\boxtimes$
						#else
						$\Box$
						#end
 						& ~privat
										
						\end{tabular}
					}\\
				Station & $!task.ward \\
				Maligner Tumor & $ \Box$  \\
				Operateur/Einsender & $!task.getPrimarySurgeon() \\
				Augenarzt & $!task.getPrimaryPrivatePhysician() 
			 
			\end{tabular}
		}
		\tabularnewline
		
	\end{tabular}
}


\begin{center}
\setlength{\tabcolsep}{0em}

#foreach ($diagnosisRevision in $task.diagnosisContainer.diagnosisRevisions)
\begin{longtable}{p{\linewidth}}
	\large \underline{ $!diagnosisRevision.name: }\\*
	\begin{addmargin}{0.2cm}
		\normalsize $!diagnosisRevision.text
	\end{addmargin}\\
	\large \underline{ Diagnose: }\\*
	\begin{addmargin}{0.2cm}
		#if($diagnosisRevision.getDiagnoses().size == 1)
			\normalsize $!diagnosisRevision.diagnoses.get(0).diagnosis;
		#else
			\begin{tabular}{p{0.15\linewidth}p{0.85\linewidth}}
			#foreach ($diagnosis in $diagnosisRevision.diagnoses)
				Präperat $!diagnosis.sample.sampleID & $!diagnosis.diagnosis \\
			#end
			\end{tabular}			
		#end
	\end{addmargin} 
\end{longtable}
#end
\end{center}
 
\begin{center}
\begin{tabular}{p{0.15\linewidth}p{0.25\linewidth}p{0.3\linewidth}p{0.3\linewidth}}
	\multicolumn{4}{l}{Mit freundlichen Grüßen} \\\\
	Freiburg den & &  $!task.diagnosisContainer.signatureOne.physician.person.fullName &  $!task.diagnosisContainer.signatureTwo.physician.person.fullName \\
	~~ $!task.diagnosisContainer.signatureDateAsDate & ~ &  $!task.diagnosisContainer.signatureOne.role & $!task.diagnosisContainer.signatureTwo.role \\\\

\end{tabular}
\end{center}
   \ifthenelse{\pageref{LastPage}>1}
     {	Dieser Befundbericht umfasst insgesamt \pageref{LastPage} Seiten. }
     {~	}
     
	

\end{document}