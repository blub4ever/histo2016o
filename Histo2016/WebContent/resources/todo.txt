-> UTF 8 Tomcat: -Dfile.encoding=UTF8
-> plink windows set PATH=C:\path\to\putty\directory;%PATH%
-> https://vladmihalcea.com/2015/02/09/hibernate-locking-patterns-how-does-optimistic_force_increment-lock-mode-work/

// generierung befundbericht final
//					if (userHandlerAction.getCurrentUser().getSettings().isPdfPreviewOnDiagnosisApproval()) {
//						// generating final diagnosis report
//						if (dialogHandlerAction.getPrintDialog().getPdfContainer()
//								.getType() != DocumentType.DIAGNOSIS_REPORT) {
//							dialogHandlerAction.getPrintDialog()
//									.setDefaultTemplateOfType(DocumentType.DIAGNOSIS_REPORT);
//						}
//
//						dialogHandlerAction.getPrintDialog().getPdfContainer()
//								.setType(DocumentType.DIAGNOSIS_REPORT_COMPLETED);
//
//						pdfDAO.attachPDF(getTask().getPatient(), getTask(),
//								dialogHandlerAction.getPrintDialog().getPdfContainer());
//					}

helper getPrinterForIP => sub { my ($self, $ip)=@_;
    my $room = Mojo::UserAgent->new->get('http://10.210.21.11:3009/DB/PLS/ip2room/ip/'.$ip)->res->json->[0]->{aufruftext};
    return sprintf("Amb-U%02d", $1) if $room =~/U([0-9]+)$/oi;
};


select flist.id, flist.name, coalesce(bool_or(fitem.task_id = 1),false) As containsTask from favouritelist flist 
left join favouritepermissionsgroup fgroup on fgroup.favouritelist_id = flist.id  
left join favouritepermissionsuser fuser on fuser.favouritelist_id = flist.id
left join favouritelistitem fitem on fitem.favouritelist_id = flist.id
left join favouritelist_histouser hideList on hideList.favouritelist_id = flist.id

where (owner_id = 1 or fgroup.group_id = 1 or fuser.user_id = 1) and (hideList.hidelistforuser_id IS NULL or hideList.hidelistforuser_id != 1) GROUP BY flist.id 

create view patientmenumodel as select patient.id, person.lastname, person.firstname, person.title, patient.piz, person.birthday from patient, person, contact where patient.person_id = person.id and person.contact_id = contact.id
create view taskmenumodel as select task.id, task.taskid, task.taskpriority, task.duedate, task.parent_id from task

Minor Changes:

-> Zimmermann --> Atzrodt, Aktualliesierien button
-> Zeitauswahl geht zumteil nicht richtig in arbeitsliste erstellen
-> Ärzte aus klinikbakcend übernehmen

-> Die Daten unter „Sendebericht“ sind die für uns wichtig? Die Uhrzeit stimmt da nicht. 
-> nach 3 monaten soll dearchiviertung nicht mehr möglich sein
-> versehendlich ausgeführte benachrichtigungen, markieren
-> Auswahl der Diagnose im Druckmenu
-> Nicht bei jeder Druckoption wird des hinterlegte Drucker angezeigt, evtl. "Globale kleine Schaltfläche" auf Hauptansicht , dann muss es nicht in jedem kleinen Fenster stehen
-> Vorgeschichte: Enter --> neue Zeile
-> Create Task material auswahl css 
-> Benachrichtigung als beendet markiert sobald die phase (auch manuell) verlassen wird, sobald in diangose phase eingetreten wird zeit auf 0 setzten
-> Suchfelder als Solche Kennzeichnen (Lupensymbol) -> (in overlay dialogen, zb. Diagosen view)
-> Bei Patient hinzufügen: kann der "Cursor" immer direkt bei PIZ sein? Macht scannen schneller
	a.	70% der fälle funktinert es
-> PDF Maker als Drucker hinterlegen (zum Testen/Ansehen der Ausdrucke)
-> Zahrand zum kontakt bearbeiten (alle) in diagnosen view
-> Auftrag hinzufügen (man muss Pixelgenau auf das + Clicken, schaltfläche geht nicht)

Urgent Changes 
-> finalizeAllDiangosisRevisions (taskManipulationHandler) löschen (diangosis filanized wird nicht mehr gebraucht)
TODO: Biobankeinwilligung beide Seiten (2 pdf-Dateien) auf einmal hochladen
TODO: Externe Proben: PIZ anlegen?
TODO: Augenarzt auswählen
TODO: Favouriten-Listen für Benutzer zugänglich machen
TODO: Latex Datei für externen Befund
TODO: DiagnosisPhaseExitDialog generierung eines abschließenden Berichtes
TODO: Erweiterte Suche 
-> sci fi /(für science finder)
TODO: Datenbankabfragen in globaleidt handler shiften


Long-term Changes 
TODO: Materialauswahl sollte wie vorgeschichte funktionieren (Eingangsbuch)
TODO: Neuladen der Listen, nachdem das Settingsmenu geschlossen wurde
TODO: Liste f�r normale benutzer �berarbeiten
TODO: rechte durchsetzten
TODO: Versionfehler beim �ffnen von dialogen handeln
TODO: object f�r Arbeitsliste muss kopiert werden, wird momentan sofort �bernommen
TODO: wenn Task entity gel�scht wird kann es sein das der beende staining phase dialog angezgit wird, geht noch nicht richitg
TODO: Ansicht abh�ngige Kn�pfe
TODO: prevent overwriting of data from clinic physicians if changed
TODO: verbessern der patientenauswahl in patienten liste
TODO: Archivieren + Dearchivieren
TODO: Konsil listenabfragen statisch, zur geschwindikeitsverbesserung
TODO: organizsation so verändern wie user + group dialog
TODO: loggin �berarbeiten, methoden in generica dat shiften
TODO: log in settings rework
TODO: Individelle Adressen beim drucken sollten aus personen gespeichert werden?
TODO: Wenn Aufträge gelöscht werden müssen pdf mit gelöscht werden..
TODO: Benachrichtigugen: Liste von fax/email/phone m�sse nur aktuallisiert werden, nicht komplett neu generiert werden, wenn man �ber den contakt dialog sachen �dnert
TODO: Freischaltungs link


v 1.0.15
++++: Brief ohne Klinik-Logo kann gedruckt werden
++++: Befundbericht bedrucken um 180 gedredt, geht wieder
++++: Beim Erstellen neuer Färbungen wird in der Auftragsübersicht der Auftrag nicht mehr als "Färbung abgeschlossen" angezeigt
++++: Datum der Unterschirft wird aktualisiert, sobald die Befundung beendet wird
++++: Patienten-Daten werden wieder richtig angezeigt

v 1.0.14
++++: Arbeitsliste grafisch und funktionell verbessert, scrollen ist jetzt möglich
++++: Kopf zum leeren der Arbeitsliste hinzugefügt
++++: Das Menu wird bei Verwendung der Navigations-Pfeile richtige geupdated 
++++: Nach hinzufügen oder Suchen eines Patienten/Auftrages/Objektträger-ID wird die Arbeitsliste neu sortiert
++++: Befund kann jetzt via Button in der Befundungsansicht abgeschlossen werden
++++: Hintergrundfärbung der Diagnosen-Tabelle umgedreht 
++++: Schnell-Suche funktioniert wieder wie erwartet.
++++: Zähler für Objektträger in Auftrag verlegt

SQL:
alter table task add slidecounter integer;
alter table task_aud add slidecounter integer;
update task set slidecounter = 0;
Alter table block drop column uniqueSlideCounter; 
Alter table block_aud drop column uniqueSlideCounter; 
ALTER TABLE slide RENAME COLUMN uniqueidinblock TO uniqueidintask;
ALTER TABLE slide_aud RENAME COLUMN uniqueidinblock TO uniqueidintask;

V 1.0.13
++++: Graphische Anpassungen am Druck-Dialog, leere Adress-Option 
++++: Wird ein Auftrag aus der Auftragsliste geladen, kam es bisher zu einem Fehler, dieser wurde behoben.
++++: Befundberichte werden nach der Benachrichtigung ausgedruckt, Feld für die Anzahl hinzugefügt
++++: Beim Erstellen eines Auftrags werden Aufklärungen nicht mehr aus einer Vorherigen Auftragserstellung übernommen.
++++: Benachrichtigungs-Dialog kann wieder über das Menu geöffnet werden
++++: Material kann manuell beim Erstellen eines Auftrages eingegeben werden
++++: Fehler beim Suchen nach Patienten ohne Auftrag behoben

SQL:
Alter table person add autoUpdate boolean;
update person set autoUpdate = false;
Alter table person_aud add autoUpdate boolean;
Alter table physician drop column manuallyAltered; 
Alter table physician_aud drop column manuallyAltered; 
alter table patient_pdfcontainer drop constraint uk_c7n1md70xsclk1c5w9yiaucl9;
alter table task_pdfcontainer drop constraint uk_rp12j1tw0yxecu9bt0b0ym72t;
alter table biobank_pdfcontainer drop constraint uk_8gmung1gnute185q5scwax2kk;
alter table council_pdfcontainer drop constraint uk_6ux59funlxk7rbbi0ejs7ir7w;

V 1.0.12
++++: Aufträge werden in der Auftragsübersicht entsprechend ihrer Auftragsnummer sortiert, nicht mehr entsprechend ihrer internen ID.
++++: Färbe-, Befundungs- und Benachrichtiguns-Prozess angepasst und entsprechende Köpfe für die einzelne Phase im Menu eingebaut.
++++: Auftrag kann archiviert/dearchiviert werden, entsprechende Rechte eingeführt.
++++: Login-Button wird gesperrt sobald ein Login erfolgt
++++: Probe/Block/Objektträger archivieren wurde in löschen umbenannt
++++: Aktuelle Versicherung wird nun angezeigt, anstelle von privat/regulär im Diagnosis View
++++: Auftrags-Nummer kann nachträglich verändert werden
++++: Recht für Änderung der Auftrags-Nummer eingeführt

SQL:
Alter table task add insurance character varying;
Alter table task_aud  add insurance character varying;
Alter table task drop column editable; 
Alter table task_aud drop column editable; 
Alter table patient drop column privateInsurance; 
Alter table patient_aud  drop column privateInsurance;
INSERT INTO histogroup_permissions (histogroup_id, permissions) VALUES (4, 'EDIT_TASK_ID');
INSERT INTO histogroup_permissions (histogroup_id, permissions) VALUES (5, 'EDIT_TASK_ID');
INSERT INTO histogroup_permissions (histogroup_id, permissions) VALUES (6, 'EDIT_TASK_ID');
INSERT INTO histogroup_permissions (histogroup_id, permissions) VALUES (7, 'EDIT_TASK_ID');
INSERT INTO histogroup_permissions (histogroup_id, permissions) VALUES (4, 'ARCHIVE_TASK');
INSERT INTO histogroup_permissions (histogroup_id, permissions) VALUES (5, 'ARCHIVE_TASK');
INSERT INTO histogroup_permissions (histogroup_id, permissions) VALUES (6, 'ARCHIVE_TASK');
INSERT INTO histogroup_permissions (histogroup_id, permissions) VALUES (7, 'ARCHIVE_TASK');
INSERT INTO histogroup_permissions (histogroup_id, permissions) VALUES (6, 'RESOTRE_TASK');
INSERT INTO histogroup_permissions (histogroup_id, permissions) VALUES (7, 'RESOTRE_TASK');


V 1.0.11
++++: Ist nur eine Probe vorhanden, wird kein Name im Diagnosen-View mehr angezeigt
++++: Diagnosen und Proben werden im Diagnosen-View wieder richtig angezeigt
++++: Hover-Texte angepasst
++++: Funktionsoberarzt/Ärztin als Auswahl bei Diagnosen-Unterschrift hinzugefügt 
++++: Auftragsnummer darf maximal 6 Zahlen enthalten, ein neuer Auftrag kann nur noch mit gültiger Auftragsnummer erstellt werden.
++++: Rechtschreibfehler korrigiert.
++++: Im Operateurauswahl-Dialog kann der Operateur jetzt auch beim Klicken auf den Namen ausgewählt werden.
++++: Ist keine Vorlage für einen Diagnose-Text vorhanden, wird der link zum Kopieren der Vorlage ausgeraut.
++++: Einlog-Routine überarbeitet, Redirect jetzt möglich, Fehlermeldung bei falschen Benutzerdaten.
++++: Malignität im Befundbericht wird richtig angezeigt, Satz über die Gültigkeit des Berichtes hinzugefügt.
++++: Editieren von externen Patienten geht wieder
++++: Logeinträge werde nicht mehr mehrfach angezeigt
++++: Die Generierung eines Befundberichtes nach Abschließen der Diagnose ist jetzt optional, kann unter Benutzereistellung aktiviert werden.
++++: Programm-Gruppen können Benutzer wieder richtig zugewiesen werden
++++: Beim Einloggen wird Groß/Kleinschreibung des Benutzernamens ignoriert
++++: Sessiontimout auf 12h gesetzt
++++: Passwort wird wieder abgefragt, war zur Debugzwecken deaktiviert.

V 1.0.10
++++: Warnung wird bei doppelter Tasknummern angezeigt
++++: Konsile sind nicht mehr bearbeitbar, wenn Auftrag finalisiert wurde
++++: Konsile werden richtig gespeichert
++++: Konsil-Dialog kann aus der Auftragsübersicht, über das Konsil-Icon aufgerufen werden
++++: Auftragsnummer manuell anpassbar, Programm zählt bei der höchten nummer des laufenden Jahres weiter
++++: Beim Konsil ausdrucken wird der Konsil-Dialog nicht mehr geschlossen
++++: Konsile enthalten mehr felder zum Dokumentieren von versendeten und zurückgekommen Proben

V 1.0.9
++++: chargen für färbungen
++++: Patienten Daten im header menu geht nicht
++++: Histouser vor einloggen hinzufügen
++++: Bennung von Proben usw verbieten, wenn task nicht editiertbar
++++: Schnelle Nachf�rbug Dialog
++++: Phasen + Phasen Buttons im Menu überprüfen
++++: batches gui für färbungen
++++: Briefliste in diagnose muss bei diagnose Änderugnen übernommen werden -< updateNotificationOnDiagnosisChange
++++: Notification! ->  save sendreport, 
++++: associated contact und associated contact notification haben beide ein custom addres field, von associated contact diese entfernen
++++: reperform send, send report latex
++++: Labelprinten überprüfen ob richtig geht
++++: Ldap, Fax überprüfen ob richtig gehen
++++: Global settings thread save -> LDAP HANDLER, LabelPrinter (stateless machen)
++++: Contact Dialog geht nicht
++++: 6: Contact Dialog mit neuem view �berarbeiten
++++: Personen m�ssen auch den Organisationen hinzuge�gt werden
++++: standard organisation + konsilare von claudia übernehmen, 
++++: versionsfehler besser handlen, refresh der seite
++++: Bilder für Konsilanzeige einabauen
++++: Diagnosen müssen default brieffelder bekommen
++++: Seach QUick add feld geht gerade nicht richtig
++++: Überprüfen ob organisationen beim ersten einloggen automatisch gestzt werden
++++: Versionkonflik beim löschen von organisationen
++++: Sort Optionen f�r worklist arbeitet nicht richtig / anzeige selected task verbessern
++++: Emailbenachrichtigung wenn externes Konsil hochgeladen wird status konsil ausstehend, erledigt als boolean feld
++++: benutzer settings
++++: Geschlecht von ldap rausfinden
++++: favouriten
++++: Bl�cke nomeklatur �berpr�fen
++++: einspeisen von operateueren abgleichen, geht zumteil nicht richtig
++++: Drucker werde gerade nicht richtig eigelsen
++++: PDF generation, wenn keien Untersucher ausgew�hlt sind geht nicht
++++: Autonomekature f�r Bl�cke arbeitet nicht + nicht �berschreiben von manuell umbenannte diagnosen
++++: Diangose text speichern, geht zurzeit nicht
++++: Konsile gehen nicht
++++: Biobank
++++: Settings Personen: Es m�ssen Haus�rzte angezeigt werden k�nnen (werden bisher nur operateure, augen�rtze/ andere
++++: Arzt muss als untersucher markiert werden f�r unterschriften
++++: notification search
++++: Kontakte, testen ob primarycontact aktuallisiert wird
++++: Sendefunktion testen!
++++: anzeige des status
++++: Diangose beenden, auswahl der templates
++++: Auswahl der Operatuere/Einsender im diagnsoe bildschirm vereinfachen
++++: Benachrichtigung �berarbeiten
++++: DiagnosenPrest Namen feld in category umbenennen
++++: Diagnosen Kategory, im erstellungs dialog
++++: Manuellen Phasenwechsel zug�nglich machen 
++++: boolean felder von task �berarbeiten
++++: Kopf f�r mehrer Diangose einabuen, Histologischer Befund als normalbefund, �ndern zu vorl�ufiger befund, Konsilbefund, nachbefund
++++: urgent: status und info dialog
++++: check patient fetch from jason form clinik -> zu viele patienten
++++: wenn kein patient gefunden, darf dieser nicht ausgew�hlt werden k�nnen
++++: print dialog auswahl der �rtze geht nicht
++++: UREPORT Printing from create dialog
++++: Multible councils
++++: Diagnose page
++++: edit page patient external
++++: Logout warn
++++: status display (in navigation)
++++: Edit external patient from menu bar
++++: Priorisierung
++++: fullName propertie of physician move to person
++++: Print-Dialog und auswahl von Files in patientenmaske

http://stackoverflow.com/questions/6149919/is-it-safe-to-start-a-new-thread-in-a-jsf-managed-bean
Session Refresh: http://stackoverflow.com/questions/3642919/javax-faces-application-viewexpiredexception-view-could-not-be-restored










